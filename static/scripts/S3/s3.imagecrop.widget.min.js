(function(b,f){function p(a,b,h){var e=R[b.type]||{};if((b.empty||h)&&null==a)return null;if(b.def&&null==a)return b.def;a=e.floor?~~a:parseFloat(a);return null==a||isNaN(a)?b.def:e.mod?(a%=e.mod,0>a?e.mod+a:a):e.min>a?e.min:e.max<a?e.max:a}function d(a){var z=k(),h=z._rgba=[];a=a.toLowerCase();m(E,function(b,r){var A=r.re.exec(a),d=A&&r.parse(A),f=r.space||"rgba",A=F[f].cache;if(d)return d=z[f](d),z[A]=d[A],h=z._rgba=d._rgba,!1});if(0!==h.length)return 0===Math.max.apply(Math,h)&&b.extend(h,K.transparent),
z;if(a=K[a])return a}function C(a,b,h){h=(h+1)%1;return 1>6*h?a+6*(b-a)*h:1>2*h?b:2>3*h?a+(b-a)*(2/3-h)*6:a}var D=/^([\-+])=\s*(\d+\.?\d*)/,E=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,
parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],k=b.Color=function(a,z,h,e){return new b.Color.fn.parse(a,z,h,e)},F={rgba:{cache:"_rgba",props:{red:{idx:0,
type:"byte",empty:!0},green:{idx:1,type:"byte",empty:!0},blue:{idx:2,type:"byte",empty:!0},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:!0},saturation:{idx:1,type:"percent",empty:!0},lightness:{idx:2,type:"percent",empty:!0}}}},R={"byte":{floor:!0,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:!0}},s=F.rgba.props,L=k.support={},K,m=b.each;F.hsla.props.alpha=s.alpha;k.fn=k.prototype={constructor:k,parse:function(a,z,h,e){if(a===f)return this._rgba=
[null,null,null,null],this;if(a instanceof b||a.nodeType)a=a instanceof b?a.css(z):b(a).css(z),z=f;var r=this,A=b.type(a),J=this._rgba=[];z!==f&&(a=[a,z,h,e],A="array");if("string"===A)return this.parse(d(a)||K._default);if("array"===A)return m(s,function(b,h){J[h.idx]=p(a[h.idx],h)}),this;if("object"===A)return a instanceof k?m(F,function(b,h){a[h.cache]&&(r[h.cache]=a[h.cache].slice())}):m(F,function(h,b){m(b.props,function(h,c){var e=b.cache;if(!r[e]&&b.to){if(null==a[h]||"alpha"===h)return;r[e]=
b.to(r._rgba)}r[e][c.idx]=p(a[h],c,!0)})}),this},is:function(a){var b=k(a),h=!0,e=this;m(F,function(a,d){var f=b[d.cache],k;f&&(k=e[d.cache]||d.to&&d.to(e._rgba)||[],m(d.props,function(a,b){if(null!=f[b.idx])return h=f[b.idx]===k[b.idx]}));return h});return h},_space:function(){var a=[],b=this;m(F,function(h,e){b[e.cache]&&a.push(h)});return a.pop()},transition:function(a,b){var h=k(a),e=h._space(),d=F[e],f=this[d.cache]||d.to(this._rgba),J=f.slice(),h=h[d.cache];m(d.props,function(a,e){var d=e.idx,
c=f[d],r=h[d],g=R[e.type]||{};null!==r&&(null===c?J[d]=r:(g.mod&&(r-c>g.mod/2?c+=g.mod:c-r>g.mod/2&&(c-=g.mod)),J[e.idx]=p((r-c)*b+c,e)))});return this[e](J)},blend:function(a){if(1===this._rgba[3])return this;var d=this._rgba.slice(),h=d.pop(),e=k(a)._rgba;return k(b.map(d,function(a,b){return(1-h)*e[b]+h*a}))},toRgbaString:function(){var a="rgba(",d=b.map(this._rgba,function(a,b){return null==a?2<b?1:0:a});1===d[3]&&(d.pop(),a="rgb(");return a+d.join(",")+")"},toHslaString:function(){var a="hsla(",
d=b.map(this.hsla(),function(a,b){null==a&&(a=2<b?1:0);b&&3>b&&(a=Math.round(100*a)+"%");return a});1===d[3]&&(d.pop(),a="hsl(");return a+d.join(",")+")"},toHexString:function(a){var d=this._rgba.slice(),h=d.pop();a&&d.push(~~(255*h));return"#"+b.map(d,function(a,b){a=(a||0).toString(16);return 1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}};k.fn.parse.prototype=k.fn;F.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,
null,null,a[3]];var b=a[0]/255,h=a[1]/255,d=a[2]/255;a=a[3];var f=Math.max(b,h,d),k=Math.min(b,h,d),m=f-k,p=f+k,I=.5*p,p=0===I||1===I?I:.5>=I?m/p:m/(2-p);return[Math.round(k===f?0:b===f?60*(h-d)/m+360:h===f?60*(d-b)/m+120:60*(b-h)/m+240)%360,p,I,null==a?1:a]};F.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,h=a[1],d=a[2];a=a[3];h=.5>=d?d*(1+h):d+h-d*h;d=2*d-h;return[Math.round(255*C(d,h,b+1/3)),Math.round(255*C(d,h,b)),Math.round(255*C(d,h,b-
1/3)),a]};m(F,function(a,d){var h=d.props,e=d.cache,r=d.to,A=d.from;k.fn[a]=function(a){r&&!this[e]&&(this[e]=r(this._rgba));if(a===f)return this[e].slice();var d=b.type(a),z="array"===d||"object"===d?a:arguments,s=this[e].slice(),c;m(h,function(a,c){var b=z["object"===d?a:c.idx];null==b&&(b=s[c.idx]);s[c.idx]=p(b,c)});return A?(c=k(A(s)),c[e]=s,c):k(s)};m(h,function(d,h){k.fn[d]||(k.fn[d]=function(e){var f=b.type(e),c="alpha"===d?this._hsla?"hsla":"rgba":a,k=this[c](),g=k[h.idx];if("undefined"===
f)return g;"function"===f&&(e=e.call(this,g),f=b.type(e));if(null==e&&h.empty)return this;"string"===f&&(f=D.exec(e))&&(e=g+parseFloat(f[2])*("+"===f[1]?1:-1));k[h.idx]=e;return this[c](k)})})});m("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),function(a,f){b.cssHooks[f]={set:function(a,e){var m,p;if("string"!==b.type(e)||(m=d(e))){e=k(m||e);if(!L.rgba&&1!==e._rgba[3]){p="backgroundColor"===f?a.parentNode:a;do m=b.curCSS(p,"backgroundColor");
while((""===m||"transparent"===m)&&(p=p.parentNode)&&p.style);e=e.blend(m&&"transparent"!==m?m:"_default")}e=e.toRgbaString()}a.style[f]=e}};b.fx.step[f]=function(a){a.colorInit||(a.start=k(a.elem,f),a.end=k(a.end),a.colorInit=!0);b.cssHooks[f].set(a.elem,a.start.transition(a.end,a.pos))}});b(function(){var a=document.createElement("div").style;a.cssText="background-color:rgba(1,1,1,.5)";L.rgba=-1<a.backgroundColor.indexOf("rgba")});K=b.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",
black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",
lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);
(function(b){b.Jcrop=function(f,p){function d(a){return Math.round(a)+"px"}function C(a){a=b(a).offset();return[a.left,a.top]}function D(a){return[a.pageX-G[0],a.pageY-G[1]]}function E(a){"object"!==typeof a&&(a={});c=b.extend(c,a);b.each(["onChange","onSelect","onRelease","onDblClick"],function(a,b){"function"!==typeof c[b]&&(c[b]=function(){})})}function k(c,b,d){G=C(w);P.setCursor("move"===c?c:c+"-resize");if("move"===c)return P.activateHandlers(R(b),a,d);b=y.getFixed();var h=s(c),T=y.getCorner(s(h));
y.setPressed(y.getCorner(h));y.setCurrent(T);P.activateHandlers(F(c,b),a,d)}function F(a,b){return function(d){if(c.aspectRatio)switch(a){case "e":d[1]=b.y+1;break;case "w":d[1]=b.y+1;break;case "n":d[0]=b.x+1;break;case "s":d[0]=b.x+1}else switch(a){case "e":d[1]=b.y2;break;case "w":d[1]=b.y2;break;case "n":d[0]=b.x2;break;case "s":d[0]=b.x2}y.setCurrent(d);u.update()}}function R(a){var c=a;ja.watchKeys();return function(a){y.moveOffset([a[0]-c[0],a[1]-c[1]]);c=a;u.update()}}function s(a){switch(a){case "n":return"sw";
case "s":return"nw";case "e":return"nw";case "w":return"ne";case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function L(a){return function(b){if(c.disabled||"move"===a&&!c.allowMove)return!1;G=C(w);X=!0;k(a,D(b));b.stopPropagation();b.preventDefault();return!1}}function K(a,c,b){var d=a.width(),T=a.height();d>c&&0<c&&(d=c,T=c/a.width()*a.height());T>b&&0<b&&(T=b,d=b/a.height()*a.width());B=a.width()/d;H=a.height()/T;a.width(d).height(T)}function m(a){return{x:a.x*
B,y:a.y*H,x2:a.x2*B,y2:a.y2*H,w:a.w*B,h:a.h*H}}function a(a){a=y.getFixed();a.w>c.minSelect[0]&&a.h>c.minSelect[1]?(u.enableHandles(),u.done()):u.release();P.setCursor(c.allowSelect?"crosshair":"default")}function z(b){if(c.disabled||!c.allowSelect)return!1;X=!0;G=C(w);u.disableHandles();P.setCursor("crosshair");var d=D(b);y.setPressed(d);u.update();P.activateHandlers(h,a,"touch"===b.type.substring(0,5));ja.watchKeys();b.stopPropagation();b.preventDefault();return!1}function h(a){y.setCurrent(a);
u.update()}function e(){var a=b("<div></div>").addClass(c.baseClass+"-tracker");M&&a.css({opacity:0,backgroundColor:"white"});return a}function r(a){A([a[0]/B,a[1]/H,a[2]/B,a[3]/H]);c.onSelect.call(N,m(y.getFixed()));u.enableHandles()}function A(a){y.setPressed([a[0],a[1]]);y.setCurrent([a[2],a[3]]);u.update()}function J(){c.disabled=!0;u.disableHandles();u.setCursor("default");P.setCursor("default")}function ba(){c.disabled=!1;ca()}function I(a,d,h){d=d||c.bgColor;c.bgFade&&b.fx.step.hasOwnProperty("backgroundColor")&&
c.fadeTime&&!h?a.animate({backgroundColor:d},{queue:!1,duration:c.fadeTime}):a.css("backgroundColor",d)}function ca(a){c.allowResize?a?u.enableOnly():u.enableHandles():u.disableHandles();P.setCursor(c.allowSelect?"crosshair":"default");u.setCursor(c.allowMove?"move":"default");c.hasOwnProperty("trueSize")&&(B=c.trueSize[0]/x,H=c.trueSize[1]/v);c.hasOwnProperty("setSelect")&&(r(c.setSelect),u.done(),delete c.setSelect);U.refresh();c.bgColor!=ma&&(I(c.shade?U.getShades():S,c.shade?c.shadeColor||c.bgColor:
c.bgColor),ma=c.bgColor);da!=c.bgOpacity&&(da=c.bgOpacity,c.shade?U.refresh():u.setBgOpacity(da));ea=c.maxSize[0]||0;fa=c.maxSize[1]||0;ga=c.minSize[0]||0;ha=c.minSize[1]||0;c.hasOwnProperty("outerImage")&&(w.attr("src",c.outerImage),delete c.outerImage);u.refresh()}var c=b.extend({},b.Jcrop.defaults),G,g=navigator.userAgent.toLowerCase(),M=/msie/.test(g),na=/msie [1-6]\./.test(g);"object"!==typeof f&&(f=b(f)[0]);"object"!==typeof p&&(p={});E(p);var g={border:"none",visibility:"visible",margin:0,
padding:0,position:"absolute",top:0,left:0},q=b(f),oa=!0;if("IMG"==f.tagName){if(0!=q[0].width&&0!=q[0].height)q.width(q[0].width),q.height(q[0].height);else{var ka=new Image;ka.src=q[0].src;q.width(ka.width);q.height(ka.height)}var w=q.clone().removeAttr("id").css(g).show();w.width(q.width());w.height(q.height());q.after(w).hide()}else w=q.css(g).show(),oa=!1,null===c.shade&&(c.shade=!0);K(w,c.boxWidth,c.boxHeight);var x=w.width(),v=w.height(),S=b("<div />").width(x).height(v).addClass(c.baseClass+
"-holder").css({position:"relative",backgroundColor:c.bgColor}).insertAfter(q).append(w);c.addClass&&S.addClass(c.addClass);var V=b("<div />"),ia=b("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),Y=b("<div />").width("100%").height("100%").css("zIndex",320),Z=b("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var a=y.getFixed();c.onDblClick.call(N,a)}).insertBefore(w).append(ia,Y);oa&&(V=b("<img />").attr("src",w.attr("src")).css(g).width(x).height(v),
ia.append(V));na&&Z.css({overflowY:"hidden"});var aa=c.boundary,W=e().width(x+2*aa).height(v+2*aa).css({position:"absolute",top:d(-aa),left:d(-aa),zIndex:290}).mousedown(z),ma=c.bgColor,da=c.bgOpacity,ea,fa,ga,ha,B,H,X,la,pa;G=C(w);var O=function(){function a(){var c={},b=["touchstart","touchmove","touchend"],d=document.createElement("div"),l;try{for(l=0;l<b.length;l++){var h=b[l],h="on"+h,g=h in d;g||(d.setAttribute(h,"return;"),g="function"==typeof d[h]);c[b[l]]=g}return c.touchstart&&c.touchend&&
c.touchmove}catch(e){return!1}}var b;b=!0===c.touchSupport||!1===c.touchSupport?c.touchSupport:a();return{createDragger:function(a){return function(b){if(c.disabled||"move"===a&&!c.allowMove)return!1;G=C(w);X=!0;k(a,D(O.cfilter(b)),!0);b.stopPropagation();b.preventDefault();return!1}},newSelection:function(a){return z(O.cfilter(a))},cfilter:function(a){a.pageX=a.originalEvent.changedTouches[0].pageX;a.pageY=a.originalEvent.changedTouches[0].pageY;return a},isSupported:a,support:b}}(),y=function(){function a(){if(!c.aspectRatio){var b=
e-g,Q=f-l;ea&&Math.abs(b)>ea&&(e=0<b?g+ea:g-ea);fa&&Math.abs(Q)>fa&&(f=0<Q?l+fa:l-fa);ha/H&&Math.abs(Q)<ha/H&&(f=0<Q?l+ha/H:l-ha/H);ga/B&&Math.abs(b)<ga/B&&(e=0<b?g+ga/B:g-ga/B);0>g&&(e-=g,g-=g);0>l&&(f-=l,l-=l);0>e&&(g-=e,e-=e);0>f&&(l-=f,f-=f);e>x&&(b=e-x,g-=b,e-=b);f>v&&(b=f-v,l-=b,f-=b);g>x&&(b=g-v,f-=b,l-=b);l>v&&(b=l-v,f-=b,l-=b);return h(d(g,l,e,f))}var b=c.aspectRatio,Q=c.minSize[0]/B,q=c.maxSize[0]/B,m=e-g,k=f-l,t=Math.abs(m),n=Math.abs(k);0===q&&(q=10*x);t/n<b?(t=f,n*=b,n=0>m?g-n:n+g,0>
n?(n=0,t=Math.abs((n-g)/b),t=0>k?l-t:t+l):n>x&&(n=x,t=Math.abs((n-g)/b),t=0>k?l-t:t+l)):(n=e,t/=b,t=0>k?l-t:l+t,0>t?(t=0,n=Math.abs((t-l)*b),n=0>m?g-n:n+g):t>v&&(t=v,n=Math.abs(t-l)*b,n=0>m?g-n:n+g));n>g?(n-g<Q?n=g+Q:n-g>q&&(n=g+q),t=t>l?l+(n-g)/b:l-(n-g)/b):n<g&&(g-n<Q?n=g-Q:g-n>q&&(n=g-q),t=t>l?l+(g-n)/b:l-(g-n)/b);0>n?(g-=n,n=0):n>x&&(g-=n-x,n=x);0>t?(l-=t,t=0):t>v&&(l-=t-v,t=v);return h(d(g,l,n,t))}function b(a){0>a[0]&&(a[0]=0);0>a[1]&&(a[1]=0);a[0]>x&&(a[0]=x);a[1]>v&&(a[1]=v);return[Math.round(a[0]),
Math.round(a[1])]}function d(a,b,c,g){var f=a,e=c,h=b,l=g;c<a&&(f=c,e=a);g<b&&(h=g,l=b);return[f,h,e,l]}function h(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var g=0,l=0,e=0,f=0,q,m;return{flipCoords:d,setPressed:function(a){a=b(a);e=g=a[0];f=l=a[1]},setCurrent:function(a){a=b(a);q=a[0]-e;m=a[1]-f;e=a[0];f=a[1]},getOffset:function(){return[q,m]},moveOffset:function(a){var b=a[0];a=a[1];0>g+b&&(b-=b+g);0>l+a&&(a-=a+l);v<f+a&&(a+=v-(f+a));x<e+b&&(b+=x-(e+b));g+=b;e+=b;l+=a;f+=
a},getCorner:function(b){var c=a();switch(b){case "ne":return[c.x2,c.y];case "nw":return[c.x,c.y];case "se":return[c.x2,c.y2];case "sw":return[c.x,c.y2]}},getFixed:a}}(),U=function(){function a(){return g(y.getFixed())}function g(a){s.top.css({left:d(a.x),width:d(a.w),height:d(a.y)});s.bottom.css({top:d(a.y2),left:d(a.x),width:d(a.w),height:d(v-a.y2)});s.right.css({left:d(a.x2),width:d(x-a.x2)});s.left.css({width:d(a.x)})}function f(){return b("<div />").css({position:"absolute",backgroundColor:c.shadeColor||
c.bgColor}).appendTo(p)}function e(){k||(k=!0,p.insertBefore(w),a(),u.setBgOpacity(1,0,1),V.hide(),h(c.shadeColor||c.bgColor,1),u.isAwake()?q(c.bgOpacity,1):q(1,1))}function h(a,b){I(m(),a,b)}function l(){k&&(p.remove(),V.show(),k=!1,u.isAwake()?u.setBgOpacity(c.bgOpacity,1,1):(u.setBgOpacity(1,1,1),u.disableHandles()),I(S,0,1))}function q(a,b){k&&(c.bgFade&&!b?p.animate({opacity:1-a},{queue:!1,duration:c.fadeTime}):p.css({opacity:1-a}))}function m(){return p.children()}var k=!1,p=b("<div />").css({position:"absolute",
zIndex:240,opacity:0}),s={top:f(),left:f().height(v),right:f().height(v),bottom:f()};return{update:a,updateRaw:g,getShades:m,setBgColor:h,enable:e,disable:l,resize:function(a,b){s.left.css({height:d(b)});s.right.css({height:d(b)})},refresh:function(){c.shade?e():l();u.isAwake()&&q(c.bgOpacity)},opacity:q}}(),u=function(){function a(c,d){var g=b("<div />").mousedown(L(c)).css({cursor:c+"-resize",position:"absolute",zIndex:d}).addClass("ord-"+c);O.support&&g.bind("touchstart.jcrop",O.createDragger(c));
Y.append(g);return g}function g(b){var c;for(c=0;c<b.length;c++)a(b[c],r++).addClass("jcrop-dragbar")}function f(a){var g,d;for(d=0;d<a.length;d++){switch(a[d]){case "n":g="hline";break;case "s":g="hline bottom";break;case "e":g="vline right";break;case "w":g="vline"}var h=x,e=a[d],l=g,l=b("<div />").css({position:"absolute",opacity:c.borderOpacity}).addClass(c.baseClass+"-"+l);ia.append(l);h[e]=l}}function h(b){var g;for(g=0;g<b.length;g++){var d=z,f=b[g],e=c.handleSize,l=a(b[g],r++).css({opacity:c.handleOpacity}).addClass(c.baseClass+
"-handle");e&&l.width(e).height(e);d[f]=l}}function q(){var a=y.getFixed();y.setPressed([a.x,a.y]);y.setCurrent([a.x2,a.y2]);l()}function l(a){if(M)return k(a)}function k(a){var b=y.getFixed(),g=b.h;Z.width(Math.round(b.w)).height(Math.round(g));var g=b.x,f=b.y;c.shade||V.css({top:d(-f),left:d(-g)});Z.css({top:d(f),left:d(g)});c.shade&&U.updateRaw(b);M||(Z.show(),c.shade?U.opacity(da):p(da,!0),M=!0);a?c.onSelect.call(N,m(b)):c.onChange.call(N,m(b))}function p(a,b,g){if(M||b)c.bgFade&&!g?w.animate({opacity:a},
{queue:!1,duration:c.fadeTime}):w.css("opacity",a)}function u(){t=!0;if(c.allowResize)return Y.show(),!0}function s(){t=!1;Y.hide()}function v(a){a?(la=!0,s()):(la=!1,u())}var M,r=370,x={},z={},t=!1;c.dragEdges&&b.isArray(c.createDragbars)&&g(c.createDragbars);b.isArray(c.createHandles)&&h(c.createHandles);c.drawBorders&&b.isArray(c.createBorders)&&f(c.createBorders);b(document).bind("touchstart.jcrop-ios",function(a){b(a.currentTarget).hasClass("jcrop-tracker")&&a.stopPropagation()});var n=e().mousedown(L("move")).css({cursor:"move",
position:"absolute",zIndex:360});O.support&&n.bind("touchstart.jcrop",O.createDragger("move"));ia.append(n);s();return{updateVisible:l,update:k,release:function(){s();Z.hide();c.shade?U.opacity(1):p(1);M=!1;c.onRelease.call(N)},refresh:q,isAwake:function(){return M},setCursor:function(a){n.css("cursor",a)},enableHandles:u,enableOnly:function(){t=!0},showHandles:function(){t&&Y.show()},disableHandles:s,animMode:v,setBgOpacity:p,done:function(){v(!1);q()}}}(),P=function(){function a(b){e(D(b));return!1}
function g(a){a.preventDefault();a.stopPropagation();X&&(X=!1,h(D(a)),u.isAwake()&&c.onSelect.call(N,m(y.getFixed())),W.css({zIndex:290}),b(document).unbind(".jcrop"),e=function(){},h=function(){});return!1}function d(a){e(D(O.cfilter(a)));return!1}function f(a){return g(O.cfilter(a))}var e=function(){},h=function(){},q=c.trackDocument;q||W.mousemove(a).mouseup(g).mouseout(g);w.before(W);return{activateHandlers:function(c,k,m){X=!0;e=c;h=k;W.css({zIndex:450});m?b(document).bind("touchmove.jcrop",
d).bind("touchend.jcrop",f):q&&b(document).bind("mousemove.jcrop",a).bind("mouseup.jcrop",g);return!1},setCursor:function(a){W.css("cursor",a)}}}(),ja=function(){function a(b){f.hide()}function g(a,b,d){c.allowMove&&(y.moveOffset([b,d]),u.updateVisible(!0));a.preventDefault();a.stopPropagation()}function d(a){if(a.ctrlKey||a.metaKey)return!0;var b=(pa=a.shiftKey?!0:!1)?10:1;switch(a.keyCode){case 37:g(a,-b,0);break;case 39:g(a,b,0);break;case 38:g(a,0,-b);break;case 40:g(a,0,b);break;case 27:c.allowSelect&&
u.release();break;case 9:return!0}return!1}var f=b('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),e=b("<div />").css({position:"absolute",overflow:"hidden"}).append(f);c.keySupport&&(f.keydown(d).blur(a),na||!c.fixedSupport?(f.css({position:"absolute",left:"-20px"}),e.append(f).insertBefore(w)):f.insertBefore(w));return{watchKeys:function(){c.keySupport&&(f.show(),f.focus())}}}();O.support&&W.bind("touchstart.jcrop",O.newSelection);Y.hide();ca(!0);
var N={setImage:function(a,b){u.release();J();var g=new Image;g.onload=function(){var d=g.height,f=c.boxWidth,e=c.boxHeight;w.width(g.width).height(d);w.attr("src",a);V.attr("src",a);K(w,f,e);x=w.width();v=w.height();V.width(x).height(v);W.width(x+2*aa).height(v+2*aa);S.width(x).height(v);U.resize(x,v);ba();"function"===typeof b&&b.call(N)};g.src=a},animateTo:function(a,b){var g=a[0]/B,d=a[1]/H,f=a[2]/B,e=a[3]/H;if(!la){var h=y.flipCoords(g,d,f,e),q=y.getFixed(),k=[q.x,q.y,q.x2,q.y2],m=c.animationDelay,
p=h[0]-k[0],s=h[1]-k[1],M=h[2]-k[2],v=h[3]-k[3],r=0,t=c.swingSpeed,g=k[0],d=k[1],f=k[2],e=k[3];u.animMode(!0);var n=function(){return function(){r+=(100-r)/t;k[0]=Math.round(g+r/100*p);k[1]=Math.round(d+r/100*s);k[2]=Math.round(f+r/100*M);k[3]=Math.round(e+r/100*v);99.8<=r&&(r=100);100>r?(A(k),window.setTimeout(n,m)):(u.done(),u.animMode(!1),"function"===typeof b&&b.call(N))}}();window.setTimeout(n,m)}},setSelect:r,setOptions:function(a){E(a);ca()},tellSelect:function(){return m(y.getFixed())},tellScaled:function(){return y.getFixed()},
setClass:function(a){S.removeClass().addClass(c.baseClass+"-holder").addClass(a)},disable:J,enable:ba,cancel:function(){u.done();P.activateHandlers(null,null)},release:u.release,destroy:function(){S.remove();q.show();q.css("visibility","visible");b(f).removeData("Jcrop")},focus:ja.watchKeys,getBounds:function(){return[x*B,v*H]},getWidgetSize:function(){return[x,v]},getScaleFactor:function(){return[B,H]},getOptions:function(){return c},ui:{holder:S,selection:Z}};M&&S.bind("selectstart",function(){return!1});
q.data("Jcrop",N);return N};b.fn.Jcrop=function(f,p){var d;this.each(function(){if(b(this).data("Jcrop")){if("api"===f)return b(this).data("Jcrop");b(this).data("Jcrop").setOptions(f)}else"IMG"==this.tagName?b.Jcrop.Loader(this,function(){b(this).css({display:"block",visibility:"hidden"});d=b.Jcrop(this,f);b.isFunction(p)&&p.call(d)}):(b(this).css({display:"block",visibility:"hidden"}),d=b.Jcrop(this,f),b.isFunction(p)&&p.call(d))});return this};b.Jcrop.Loader=function(f,p,d){function C(){E.complete?
(D.unbind(".jcloader"),b.isFunction(p)&&p.call(E)):window.setTimeout(C,50)}var D=b(f),E=D[0];D.bind("load.jcloader",C).bind("error.jcloader",function(f){D.unbind(".jcloader");b.isFunction(d)&&d.call(E)});E.complete&&b.isFunction(p)&&(D.unbind(".jcloader"),p.call(E))};b.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:"n s e w nw ne se sw".split(" "),
createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);
$(function(){var b="png PNG jpg JPG jpeg JPEG".split(" "),f,p=$(".imagecrop-canvas"),d=p[0],C=d.width;heightLimit=d.height;toScale=!0;if(0==C||0==heightLimit)toScale=!1,C=heightLimit=600;var D=function(a){a=a.type.split("/");var c=a[0];f=a[a.length-1];if("image"==c&&-1!=$.inArray(f,b))return f="png"==f||"PNG"==f?"png":"jpeg",!0},E,k,F=function(a){E=a},R=function(a){a.stopPropagation();a.preventDefault();a.target.className="imagecrop-drag";"dragover"==a.type&&(a.target.className="imagecrop-drag hover")},
s,L,K,m=new Image,a=function(a){var b;m.src=a;m.onload=function(){var c=[C,heightLimit],e=[m.width,m.height];e[0]>c[0]&&(k=c[0]/e[0],e[0]*=k,e[1]*=k);e[1]>c[1]&&(k=c[1]/e[1],e[0]*=k,e[1]*=k);e[0]=Math.floor(e[0]);e[1]=Math.floor(e[1]);L=e;d.width=L[0];d.height=L[1];d.getContext("2d").drawImage(m,0,0,L[0],L[1]);b=d.toDataURL("image/"+f);toScale?$(".imagecrop-data").val(K+";"+b):$(".imagecrop-data").val(K+";"+a);$("#uploaded-image").attr({src:b,style:"display: block"});$("#select-crop-btn").css({display:"inline"});
$("hr").attr({style:"display:block"})}},z=$("#upload-title"),h=$("#upload-container");z.bind("click",function(a){h.slideDown("fast",function(){z.html(i18n.upload_image)})});var e=function(b){s&&s.destroy();setTimeout(function(){h.slideUp("fast",function(){z.html("<a>"+i18n.upload_new_image+"</a>")})},500);var c=new FileReader,d=(b.target.files||b.originalEvent.dataTransfer.files)[0];K=d.name;E=b;"drop"==b.type&&R(b);b=$(".imagecrop-upload");D(d)?(c.onload=function(b){a(b.target.result)},c.readAsDataURL(d)):
alert(i18n.invalid_image+"\n"+i18n.supported_image_formats+": png, jpeg or jpg");b.val("")},r=$("#select-crop-btn"),A=$("#crop-btn"),J=$("#remove-btn"),ba=$('input[name="imagecrop-points"]'),I=function(a){s.release();s.disable();A.css({display:"none"});J.css({display:"none"});r.css({display:"inline"})};r.bind("click",function(a){s.enable();var b=s.getBounds();a=b[0]/2;var c=b[1]/2,d=b[0]/4,b=b[1]/4;s.animateTo([a-d,c-b,a+d,c+b]);r.css({display:"none"});A.css({display:"inline"});J.css({display:"inline"})});
A.bind("click",function(b){var c=$(".jcrop-holder");b=parseInt(c.css("width").split("px")[0]);var e=parseInt(c.css("height").split("px")[0]),c=m.width/b,e=m.height/e;b=ba.val().split(",");var h=b[0],k=b[1],r=b[3];b=Math.round((b[2]-h)*c);e=Math.round((r-k)*e);s.destroy();I(E);p.attr({width:b,height:e});d.getContext("2d").drawImage(m,Math.round(h*c),Math.round(k*c),b,e,0,0,b,e);b=d.toDataURL("image/"+f);a(b)});J.bind("click",I);var ca=function(a){ba.val(a.x+","+a.y+","+a.x2+","+a.y2)};$("#uploaded-image").bind("load",
function(a){a=$(this);s&&(s.destroy(),I(E));a.Jcrop({onChange:ca,opacity:.2,bgFade:!0,bgColor:"black",addClass:"jcrop-light"},function(){s=this;s.getBounds();s.ui.selection.addClass("jcrop-selection");s.disable()})});var c=$(".imagecrop-data").attr("value");if(void 0!=typeof c){F(document.createEvent("Event"));var G=new Image;G.src=c;G.onload=function(){p.attr({width:G.width,height:G.height});d.getContext("2d").drawImage(G,0,0,G.width,G.height);var b=c.split(".");f=b[b.length-1];"jpg"==f&&(f="jpeg");
K="upload."+f;b=d.toDataURL("image/"+f);a(b)}}$(".imagecrop-drag").bind("dragover",R).bind("dragleave",R).bind("drop",e);$(".imagecrop-upload").bind("change",e)});
