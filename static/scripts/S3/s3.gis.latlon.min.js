(function(){function g(a){return!isNaN(parseFloat(a))&&isFinite(a)}function h(a){return a.parents(".gis_coord_wrap").eq(0)}function k(a){return function(b){a.val(b||"");"undefined"==typeof b&&a.focus()}}function p(a){var b=Math.abs(a),b=60*(b-parseInt(b,10));if(1E-10>Math.abs(b-Math.round(b)))b=Math.round(b),c=0;else{var c=60*(b-parseInt(b,10));1E-10>Math.abs(c-Math.round(c))&&(c=Math.round(c))}return{d:parseInt(a,10),m:parseInt(b,10),s:c}}function q(a){var b=$(".degrees",a).val()||0,c=$(".minutes",
a).val()||0,d=$(".seconds",a).val()||0,e=k($(".degrees",a)),m=k($(".minutes",a)),n=k($(".seconds",a)),h=k($(".decimal",a));a="gis_location_lat"==$(".decimal",a).attr("id");g(b)?(b=Number(b),Math.abs(b)>(a?90:180)?(alert(f.degrees[a?"lat":"lon"]),e()):g(c)?(c=Math.abs(c),60<c?(alert(f.minutes),m()):g(d)?(d=Math.abs(d),60<=d?(alert(f.seconds),n()):(b=(0>b?-1:1)*(Math.abs(b)+c/60+d/3600),Math.abs(b)>(a?90:180)?alert(f.decimal[a?"lat":"lon"]):(a=p(b),h(""+b),e(a.d||"0"),m(a.m||"0"),n(a.s||"0")))):(alert(l.seconds),
n())):(alert(l.minutes),m())):(alert(l.degrees),e())}function e(a){var b=$(".decimal",a),c=b.val(),d="gis_location_lat"==$(".decimal",a).attr("id");""!==c&&(g(c)?(c=Number(c),Math.abs(c)>(d?90:180)?(alert(f.decimal[d?"lat":"lon"]),b.focus()):(b=p(c),$(".degrees",a).val(b.d||"0"),$(".minutes",a).val(b.m||"0"),$(".seconds",a).val(b.s||"0"))):(alert(l.decimal),b.val("").focus()))}var l=i18n.gis_only_numbers,f=i18n.gis_range_error;$(".gis_coord_dms input").blur(function(){q(h($(this)))}).keypress(function(a){13==
a.which&&a.preventDefault()});$(document).ready(function(){$(".gis_coord_decimal input").blur(function(){e(h($(this)))}).keypress(function(a){13==a.which&&a.preventDefault()});$(".gis_coord_switch_dms").click(function(a){$(".gis_coord_dms").show();$(".gis_coord_decimal").hide();$(".gis_coord_wrap").each(function(){e($(this))});a.preventDefault()});$(".gis_coord_switch_decimal").click(function(a){$(".gis_coord_decimal").show();$(".gis_coord_dms").hide();$(".gis_coord_wrap").each(function(){q($(this))});
a.preventDefault()});$(".gis_coord_wrap").each(function(){e($(this))})})})(jQuery);
