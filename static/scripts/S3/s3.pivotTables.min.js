/*
: 2013 (c) Sahana Software Foundation
 @license: MIT

 requires: jQuery 1.9.1+
 requires: jQuery UI 1.10 widget factory

*/
(function(d){d.color={};d.color.make=function(D,a,e,c){var b={};b.r=D||0;b.g=a||0;b.b=e||0;b.a=null!=c?c:1;b.add=function(d,a){for(var e=0;e<d.length;++e)b[d.charAt(e)]+=a;return b.normalize()};b.scale=function(d,a){for(var e=0;e<d.length;++e)b[d.charAt(e)]*=a;return b.normalize()};b.toString=function(){return 1<=b.a?"rgb("+[b.r,b.g,b.b].join()+")":"rgba("+[b.r,b.g,b.b,b.a].join()+")"};b.normalize=function(){function d(a,e,b){return e<a?a:e>b?b:e}b.r=d(0,parseInt(b.r),255);b.g=d(0,parseInt(b.g),255);
b.b=d(0,parseInt(b.b),255);b.a=d(0,b.a,1);return b};b.clone=function(){return d.color.make(b.r,b.b,b.g,b.a)};return b.normalize()};d.color.extract=function(D,a){var e;do{e=D.css(a).toLowerCase();if(""!=e&&"transparent"!=e)break;D=D.parent()}while(!d.nodeName(D.get(0),"body"));"rgba(0, 0, 0, 0)"==e&&(e="transparent");return d.color.parse(e)};d.color.parse=function(D){var a,e=d.color.make;if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(D))return e(parseInt(a[1],10),parseInt(a[2],
10),parseInt(a[3],10));if(a=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(D))return e(parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),parseFloat(a[4]));if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(D))return e(2.55*parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]));if(a=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(D))return e(2.55*
parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]),parseFloat(a[4]));if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(D))return e(parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16));if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(D))return e(parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16));D=d.trim(D).toLowerCase();if("transparent"==D)return e(255,255,255,0);a=C[D]||[0,0,0];return e(a[0],a[1],a[2])};var C={aqua:[0,255,255],azure:[240,255,255],beige:[245,
245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,
144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
(function(d){function C(a,c){var b=c.children("."+a)[0];if(null==b&&(b=document.createElement("canvas"),b.className=a,d(b).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(c),!b.getContext))if(window.G_vmlCanvasManager)b=window.G_vmlCanvasManager.initElement(b);else throw Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=
b;b=this.context=b.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1);this.resize(c.width(),c.height());this.textContainer=null;this.text={};this._textCache={}}function D(a,c,b,h){function f(l,z){z=[G].concat(z);for(var k=0;k<l.length;++k)l[k].apply(this,z)}function g(l){for(var z=[],k=0;k<l.length;++k){var a=d.extend(!0,{},m.series);null!=l[k].data?
(a.data=l[k].data,delete l[k].data,d.extend(!0,a,l[k]),l[k].data=a.data):a.data=l[k];z.push(a)}F=z;k=F.length;z=-1;for(l=0;l<F.length;++l)a=F[l].color,null!=a&&(k--,"number"==typeof a&&a>z&&(z=a));k<=z&&(k=z+1);var z=[],s=m.colors,e=s.length,b=0;for(l=0;l<k;l++)a=d.color.parse(s[l%e]||"#666"),0==l%e&&l&&(b=0<=b?0.5>b?-b-0.2:0:-b),z[l]=a.scale("rgb",1+b);for(l=k=0;l<F.length;++l){a=F[l];null==a.color?(a.color=z[k].toString(),++k):"number"==typeof a.color&&(a.color=z[a.color].toString());if(null==a.lines.show){var c,
s=!0;for(c in a)if(a[c]&&a[c].show){s=!1;break}s&&(a.lines.show=!0)}null==a.lines.zero&&(a.lines.zero=!!a.lines.fill);a.xaxis=y(P,r(a,"x"));a.yaxis=y(W,r(a,"y"))}H()}function r(l,a){var k=l[a+"axis"];"object"==typeof k&&(k=k.n);"number"!=typeof k&&(k=1);return k}function q(){return d.grep(P.concat(W),function(l){return l})}function t(l){var a={},k,d;for(k=0;k<P.length;++k)(d=P[k])&&d.used&&(a["x"+d.n]=d.c2p(l.left));for(k=0;k<W.length;++k)(d=W[k])&&d.used&&(a["y"+d.n]=d.c2p(l.top));void 0!==a.x1&&
(a.x=a.x1);void 0!==a.y1&&(a.y=a.y1);return a}function y(l,a){l[a-1]||(l[a-1]={n:a,direction:l==P?"x":"y",options:d.extend(!0,{},l==P?m.xaxis:m.yaxis)});return l[a-1]}function H(){function l(l,a,k){a<l.datamin&&a!=-e&&(l.datamin=a);k>l.datamax&&k!=e&&(l.datamax=k)}var a=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,e=Number.MAX_VALUE,s,b,A,c,u,m,I,h,n,g,p,M;d.each(q(),function(l,d){d.datamin=a;d.datamax=k;d.used=!1});for(s=0;s<F.length;++s)u=F[s],u.datapoints={points:[]},f(U.processRawData,
[u,u.data,u.datapoints]);for(s=0;s<F.length;++s){u=F[s];p=u.data;M=u.datapoints.format;if(!M){M=[];M.push({x:!0,number:!0,required:!0});M.push({y:!0,number:!0,required:!0});if(u.bars.show||u.lines.show&&u.lines.fill)M.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:!!(u.bars.show&&u.bars.zero||u.lines.show&&u.lines.zero)}),u.bars.horizontal&&(delete M[M.length-1].y,M[M.length-1].x=!0);u.datapoints.format=M}if(null==u.datapoints.pointsize){u.datapoints.pointsize=M.length;I=u.datapoints.pointsize;
m=u.datapoints.points;var da=u.lines.show&&u.lines.steps;u.xaxis.used=u.yaxis.used=!0;for(b=A=0;b<p.length;++b,A+=I){g=p[b];var ma=null==g;if(!ma)for(c=0;c<I;++c){h=g[c];if(n=M[c])n.number&&null!=h&&(h=+h,isNaN(h)?h=null:Infinity==h?h=e:-Infinity==h&&(h=-e)),null==h&&(n.required&&(ma=!0),null!=n.defaultValue&&(h=n.defaultValue));m[A+c]=h}if(ma)for(c=0;c<I;++c)h=m[A+c],null!=h&&(n=M[c],n.x&&l(u.xaxis,h,h),n.y&&l(u.yaxis,h,h)),m[A+c]=null;else if(da&&0<A&&null!=m[A-I]&&m[A-I]!=m[A]&&m[A-I+1]!=m[A+1]){for(c=
0;c<I;++c)m[A+I+c]=m[A+c];m[A+1]=m[A-I+1];A+=I}}}}for(s=0;s<F.length;++s)u=F[s],f(U.processDatapoints,[u,u.datapoints]);for(s=0;s<F.length;++s){u=F[s];m=u.datapoints.points;I=u.datapoints.pointsize;M=u.datapoints.format;g=A=a;da=p=k;for(b=0;b<m.length;b+=I)if(null!=m[b])for(c=0;c<I;++c)h=m[b+c],(n=M[c])&&(!1!==n.autoscale&&h!=e&&h!=-e)&&(n.x&&(h<A&&(A=h),h>p&&(p=h)),n.y&&(h<g&&(g=h),h>da&&(da=h)));if(u.bars.show){switch(u.bars.align){case "left":b=0;break;case "right":b=-u.bars.barWidth;break;case "center":b=
-u.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+u.bars.align);}u.bars.horizontal?(g+=b,da+=b+u.bars.barWidth):(A+=b,p+=b+u.bars.barWidth)}l(u.xaxis,A,p);l(u.yaxis,g,da)}d.each(q(),function(l,d){d.datamin==a&&(d.datamin=null);d.datamax==k&&(d.datamax=null)})}function E(l){function a(l){return l}var k,d,b=l.options.transform||a,e=l.options.inverseTransform;"x"==l.direction?(k=l.scale=Y/Math.abs(b(l.max)-b(l.min)),d=Math.min(b(l.max),b(l.min))):(k=l.scale=V/Math.abs(b(l.max)-b(l.min)),
k=-k,d=Math.max(b(l.max),b(l.min)));l.p2c=b==a?function(l){return(l-d)*k}:function(l){return(b(l)-d)*k};l.c2p=e?function(l){return e(d+l/k)}:function(l){return d+l/k}}function ba(l){var a=l.labelWidth,k=l.labelHeight,b=l.options.position,e=l.options.tickLength,c=m.grid.axisMargin,A=m.grid.labelMargin,h="x"==l.direction?P:W,u,n=d.grep(h,function(l){return l&&l.options.position==b&&l.reserveSpace});d.inArray(l,n)==n.length-1&&(c=0);null==e&&(e=d.grep(h,function(l){return l&&l.reserveSpace}),e=(u=0==
d.inArray(l,e))?"full":5);isNaN(+e)||(A+=+e);"x"==l.direction?(k+=A,"bottom"==b?(v.bottom+=k+c,l.box={top:L.height-v.bottom,height:k}):(l.box={top:v.top+c,height:k},v.top+=k+c)):(a+=A,"left"==b?(l.box={left:v.left+c,width:a},v.left+=a+c):(v.right+=a+c,l.box={left:L.width-v.right,width:a}));l.position=b;l.tickLength=e;l.box.padding=A;l.innermost=u}function D(){var l=m.grid.minBorderMargin,a={x:0,y:0},k;if(null==l)for(k=l=0;k<F.length;++k)l=Math.max(l,2*(F[k].points.radius+F[k].points.lineWidth/2));
a.x=a.y=Math.ceil(l);d.each(q(),function(l,k){var d=k.direction;k.reserveSpace&&(a[d]=Math.ceil(Math.max(a[d],("x"==d?k.labelWidth:k.labelHeight)/2)))});v.left=Math.max(a.x,v.left);v.right=Math.max(a.x,v.right);v.top=Math.max(a.y,v.top);v.bottom=Math.max(a.y,v.bottom)}function w(){var l,a=q(),k=m.grid.show;for(l in v){var b=m.grid.margin||0;v[l]="number"==typeof b?b:b[l]||0}f(U.processOffset,[v]);for(l in v)v[l]="object"==typeof m.grid.borderWidth?v[l]+(k?m.grid.borderWidth[l]:0):v[l]+(k?m.grid.borderWidth:
0);d.each(a,function(l,a){a.show=a.options.show;null==a.show&&(a.show=a.used);a.reserveSpace=a.show||a.options.reserveSpace;var k=a.options,d=+(null!=k.min?k.min:a.datamin),b=+(null!=k.max?k.max:a.datamax),e=b-d;if(0==e){if(e=0==b?1:0.01,null==k.min&&(d-=e),null==k.max||null!=k.min)b+=e}else{var z=k.autoscaleMargin;null!=z&&(null==k.min&&(d-=e*z,0>d&&(null!=a.datamin&&0<=a.datamin)&&(d=0)),null==k.max&&(b+=e*z,0<b&&(null!=a.datamax&&0>=a.datamax)&&(b=0)))}a.min=d;a.max=b});if(k){b=d.grep(a,function(l){return l.reserveSpace});
d.each(b,function(l,a){Q(a);var k=a.options.ticks,b=[];null==k||"number"==typeof k&&0<k?b=a.tickGenerator(a):k&&(b=d.isFunction(k)?k(a):k);var e;a.ticks=[];for(k=0;k<b.length;++k){var z=null,c=b[k];"object"==typeof c?(e=+c[0],1<c.length&&(z=c[1])):e=+c;null==z&&(z=a.tickFormatter(e,a));isNaN(e)||a.ticks.push({v:e,label:z})}b=a.ticks;a.options.autoscaleMargin&&0<b.length&&(null==a.options.min&&(a.min=Math.min(a.min,b[0].v)),null==a.options.max&&1<b.length&&(a.max=Math.max(a.max,b[b.length-1].v)));
b=a.options;k=a.ticks||[];e=b.labelWidth||0;for(var z=b.labelHeight||0,c="flot-"+a.direction+"-axis flot-"+a.direction+a.n+"-axis "+(a.direction+"Axis "+a.direction+a.n+"Axis"),m=b.font||"flot-tick-label tickLabel",h=0;h<k.length;++h){var ca=k[h];ca.label&&(ca=L.getTextInfo(c,ca.label,m),null==b.labelWidth&&(e=Math.max(e,ca.width)),null==b.labelHeight&&(z=Math.max(z,ca.height)))}a.labelWidth=Math.ceil(e);a.labelHeight=Math.ceil(z)});for(l=b.length-1;0<=l;--l)ba(b[l]);D();d.each(b,function(l,a){"x"==
a.direction?(a.box.left=v.left-a.labelWidth/2,a.box.width=L.width-v.left-v.right+a.labelWidth):(a.box.top=v.top-a.labelHeight/2,a.box.height=L.height-v.bottom-v.top+a.labelHeight)})}Y=L.width-v.left-v.right;V=L.height-v.bottom-v.top;d.each(a,function(l,a){E(a)});k&&R();B()}function Q(l){var a=l.options,k;k="number"==typeof a.ticks&&0<a.ticks?a.ticks:0.3*Math.sqrt("x"==l.direction?L.width:L.height);k=(l.max-l.min)/k;var b=-Math.floor(Math.log(k)/Math.LN10),e=a.tickDecimals;null!=e&&b>e&&(b=e);var c=
Math.pow(10,-b),m=k/c,h;1.5>m?h=1:3>m?(h=2,2.25<m&&(null==e||b+1<=e)&&(h=2.5,++b)):h=7.5>m?5:10;h*=c;null!=a.minTickSize&&h<a.minTickSize&&(h=a.minTickSize);l.delta=k;l.tickDecimals=Math.max(0,null!=e?e:b);l.tickSize=a.tickSize||h;if("time"==a.mode&&!l.tickGenerator)throw Error("Time mode requires the flot.time plugin.");l.tickGenerator||(l.tickGenerator=function(a){var l=[],k=a.tickSize*Math.floor(a.min/a.tickSize),d=0,b=Number.NaN,e;do e=b,b=k+d*a.tickSize,l.push(b),++d;while(b<a.max&&b!=e);return l},
l.tickFormatter=function(a,l){var k=l.tickDecimals?Math.pow(10,l.tickDecimals):1,d=""+Math.round(a*k)/k;if(null!=l.tickDecimals){var b=d.indexOf("."),b=-1==b?0:d.length-b-1;if(b<l.tickDecimals)return(b?d:d+".")+(""+k).substr(1,l.tickDecimals-b)}return d});d.isFunction(a.tickFormatter)&&(l.tickFormatter=function(l,k){return""+a.tickFormatter(l,k)});if(null!=a.alignTicksWithAxis){var u=("x"==l.direction?P:W)[a.alignTicksWithAxis-1];u&&(u.used&&u!=l)&&(k=l.tickGenerator(l),0<k.length&&(null==a.min&&
(l.min=Math.min(l.min,k[0])),null==a.max&&1<k.length&&(l.max=Math.max(l.max,k[k.length-1]))),l.tickGenerator=function(a){var l=[],k,d;for(d=0;d<u.ticks.length;++d)k=(u.ticks[d].v-u.min)/(u.max-u.min),k=a.min+k*(a.max-a.min),l.push(k);return l},l.mode||null!=a.tickDecimals||(k=Math.max(0,-Math.floor(Math.log(l.delta)/Math.LN10)+1),b=l.tickGenerator(l),1<b.length&&/\..*0$/.test((b[1]-b[0]).toFixed(k))||(l.tickDecimals=k)))}}function p(){L.clear();f(U.drawBackground,[n]);var a=m.grid;a.show&&a.backgroundColor&&
(n.save(),n.translate(v.left,v.top),n.fillStyle=oa(m.grid.backgroundColor,V,0,"rgba(255, 255, 255, 0)"),n.fillRect(0,0,Y,V),n.restore());a.show&&!a.aboveData&&K();for(var d=0;d<F.length;++d){f(U.drawSeries,[n,F[d]]);var k=F[d];k.lines.show&&O(k);k.bars.show&&ra(k);k.points.show&&J(k)}f(U.draw,[n]);a.show&&a.aboveData&&K();L.render()}function x(a,d){for(var k,b,e,c,h=q(),m=0;m<h.length;++m)if(k=h[m],k.direction==d&&(c=d+k.n+"axis",a[c]||1!=k.n||(c=d+"axis"),a[c])){b=a[c].from;e=a[c].to;break}a[c]||
(k="x"==d?P[0]:W[0],b=a[d+"1"],e=a[d+"2"]);null!=b&&(null!=e&&b>e)&&(c=b,b=e,e=c);return{from:b,to:e,axis:k}}function K(){var a,b,k;n.save();n.translate(v.left,v.top);if(k=m.grid.markings)for(d.isFunction(k)&&(b=G.getAxes(),b.xmin=b.xaxis.min,b.xmax=b.xaxis.max,b.ymin=b.yaxis.min,b.ymax=b.yaxis.max,k=k(b)),a=0;a<k.length;++a){b=k[a];var e=x(b,"x"),c=x(b,"y");null==e.from&&(e.from=e.axis.min);null==e.to&&(e.to=e.axis.max);null==c.from&&(c.from=c.axis.min);null==c.to&&(c.to=c.axis.max);e.to<e.axis.min||
(e.from>e.axis.max||c.to<c.axis.min||c.from>c.axis.max)||(e.from=Math.max(e.from,e.axis.min),e.to=Math.min(e.to,e.axis.max),c.from=Math.max(c.from,c.axis.min),c.to=Math.min(c.to,c.axis.max),e.from==e.to&&c.from==c.to)||(e.from=e.axis.p2c(e.from),e.to=e.axis.p2c(e.to),c.from=c.axis.p2c(c.from),c.to=c.axis.p2c(c.to),e.from==e.to||c.from==c.to?(n.beginPath(),n.strokeStyle=b.color||m.grid.markingsColor,n.lineWidth=b.lineWidth||m.grid.markingsLineWidth,n.moveTo(e.from,c.from),n.lineTo(e.to,c.to),n.stroke()):
(n.fillStyle=b.color||m.grid.markingsColor,n.fillRect(e.from,c.to,e.to-e.from,c.from-c.to)))}b=q();k=m.grid.borderWidth;for(e=0;e<b.length;++e){c=b[e];a=c.box;var h=c.tickLength,A,f,u,g;if(c.show&&0!=c.ticks.length){n.lineWidth=1;"x"==c.direction?(A=0,f="full"==h?"top"==c.position?0:V:a.top-v.top+("top"==c.position?a.height:0)):(f=0,A="full"==h?"left"==c.position?0:Y:a.left-v.left+("left"==c.position?a.width:0));c.innermost||(n.strokeStyle=c.options.color,n.beginPath(),u=g=0,"x"==c.direction?u=Y+
1:g=V+1,1==n.lineWidth&&("x"==c.direction?f=Math.floor(f)+0.5:A=Math.floor(A)+0.5),n.moveTo(A,f),n.lineTo(A+u,f+g),n.stroke());n.strokeStyle=c.options.tickColor;n.beginPath();for(a=0;a<c.ticks.length;++a){var I=c.ticks[a].v;u=g=0;isNaN(I)||(I<c.min||I>c.max||"full"==h&&("object"==typeof k&&0<k[c.position]||0<k)&&(I==c.min||I==c.max))||("x"==c.direction?(A=c.p2c(I),g="full"==h?-V:h,"top"==c.position&&(g=-g)):(f=c.p2c(I),u="full"==h?-Y:h,"left"==c.position&&(u=-u)),1==n.lineWidth&&("x"==c.direction?
A=Math.floor(A)+0.5:f=Math.floor(f)+0.5),n.moveTo(A,f),n.lineTo(A+u,f+g))}n.stroke()}}k&&(a=m.grid.borderColor,"object"==typeof k||"object"==typeof a?("object"!==typeof k&&(k={top:k,right:k,bottom:k,left:k}),"object"!==typeof a&&(a={top:a,right:a,bottom:a,left:a}),0<k.top&&(n.strokeStyle=a.top,n.lineWidth=k.top,n.beginPath(),n.moveTo(0-k.left,0-k.top/2),n.lineTo(Y,0-k.top/2),n.stroke()),0<k.right&&(n.strokeStyle=a.right,n.lineWidth=k.right,n.beginPath(),n.moveTo(Y+k.right/2,0-k.top),n.lineTo(Y+k.right/
2,V),n.stroke()),0<k.bottom&&(n.strokeStyle=a.bottom,n.lineWidth=k.bottom,n.beginPath(),n.moveTo(Y+k.right,V+k.bottom/2),n.lineTo(0,V+k.bottom/2),n.stroke()),0<k.left&&(n.strokeStyle=a.left,n.lineWidth=k.left,n.beginPath(),n.moveTo(0-k.left/2,V+k.bottom),n.lineTo(0-k.left/2,0),n.stroke())):(n.lineWidth=k,n.strokeStyle=m.grid.borderColor,n.strokeRect(-k/2,-k/2,Y+k,V+k)));n.restore()}function R(){d.each(q(),function(a,b){if(b.show&&0!=b.ticks.length){var k=b.box,d="flot-"+b.direction+"-axis flot-"+
b.direction+b.n+"-axis "+(b.direction+"Axis "+b.direction+b.n+"Axis"),e=b.options.font||"flot-tick-label tickLabel",c,h,m,u,f;L.removeText(d);for(var n=0;n<b.ticks.length;++n)c=b.ticks[n],!c.label||(c.v<b.min||c.v>b.max)||("x"==b.direction?(u="center",h=v.left+b.p2c(c.v),"bottom"==b.position?m=k.top+k.padding:(m=k.top+k.height-k.padding,f="bottom")):(f="middle",m=v.top+b.p2c(c.v),"left"==b.position?(h=k.left+k.width-k.padding,u="right"):h=k.left+k.padding),L.addText(d,h,m,c.label,e,null,u,f))}})}
function O(a){function b(a,l,k,d,e){var c=a.points;a=a.pointsize;var h=null,m=null;n.beginPath();for(var z=a;z<c.length;z+=a){var f=c[z-a],g=c[z-a+1],s=c[z],p=c[z+1];if(null!=f&&null!=s){if(g<=p&&g<e.min){if(p<e.min)continue;f=(e.min-g)/(p-g)*(s-f)+f;g=e.min}else if(p<=g&&p<e.min){if(g<e.min)continue;s=(e.min-g)/(p-g)*(s-f)+f;p=e.min}if(g>=p&&g>e.max){if(p>e.max)continue;f=(e.max-g)/(p-g)*(s-f)+f;g=e.max}else if(p>=g&&p>e.max){if(g>e.max)continue;s=(e.max-g)/(p-g)*(s-f)+f;p=e.max}if(f<=s&&f<d.min){if(s<
d.min)continue;g=(d.min-f)/(s-f)*(p-g)+g;f=d.min}else if(s<=f&&s<d.min){if(f<d.min)continue;p=(d.min-f)/(s-f)*(p-g)+g;s=d.min}if(f>=s&&f>d.max){if(s>d.max)continue;g=(d.max-f)/(s-f)*(p-g)+g;f=d.max}else if(s>=f&&s>d.max){if(f>d.max)continue;p=(d.max-f)/(s-f)*(p-g)+g;s=d.max}f==h&&g==m||n.moveTo(d.p2c(f)+l,e.p2c(g)+k);h=s;m=p;n.lineTo(d.p2c(s)+l,e.p2c(p)+k)}}n.stroke()}function k(a,l,b){var d=a.points;a=a.pointsize;for(var k=Math.min(Math.max(0,b.min),b.max),e=0,c=!1,h=1,m=0,z=0;!(0<a&&e>d.length+
a);){var e=e+a,f=d[e-a],g=d[e-a+h],s=d[e],p=d[e+h];if(c){if(0<a&&null!=f&&null==s){z=e;a=-a;h=2;continue}if(0>a&&e==m+a){n.fill();c=!1;a=-a;h=1;e=m=z+a;continue}}if(null!=f&&null!=s){if(f<=s&&f<l.min){if(s<l.min)continue;g=(l.min-f)/(s-f)*(p-g)+g;f=l.min}else if(s<=f&&s<l.min){if(f<l.min)continue;p=(l.min-f)/(s-f)*(p-g)+g;s=l.min}if(f>=s&&f>l.max){if(s>l.max)continue;g=(l.max-f)/(s-f)*(p-g)+g;f=l.max}else if(s>=f&&s>l.max){if(f>l.max)continue;p=(l.max-f)/(s-f)*(p-g)+g;s=l.max}c||(n.beginPath(),n.moveTo(l.p2c(f),
b.p2c(k)),c=!0);if(g>=b.max&&p>=b.max)n.lineTo(l.p2c(f),b.p2c(b.max)),n.lineTo(l.p2c(s),b.p2c(b.max));else if(g<=b.min&&p<=b.min)n.lineTo(l.p2c(f),b.p2c(b.min)),n.lineTo(l.p2c(s),b.p2c(b.min));else{var ca=f,q=s;g<=p&&g<b.min&&p>=b.min?(f=(b.min-g)/(p-g)*(s-f)+f,g=b.min):p<=g&&(p<b.min&&g>=b.min)&&(s=(b.min-g)/(p-g)*(s-f)+f,p=b.min);g>=p&&g>b.max&&p<=b.max?(f=(b.max-g)/(p-g)*(s-f)+f,g=b.max):p>=g&&(p>b.max&&g<=b.max)&&(s=(b.max-g)/(p-g)*(s-f)+f,p=b.max);f!=ca&&n.lineTo(l.p2c(ca),b.p2c(g));n.lineTo(l.p2c(f),
b.p2c(g));n.lineTo(l.p2c(s),b.p2c(p));s!=q&&(n.lineTo(l.p2c(s),b.p2c(p)),n.lineTo(l.p2c(q),b.p2c(p)))}}}}n.save();n.translate(v.left,v.top);n.lineJoin="round";var d=a.lines.lineWidth,e=a.shadowSize;if(0<d&&0<e){n.lineWidth=e;n.strokeStyle="rgba(0,0,0,0.1)";var c=Math.PI/18;b(a.datapoints,Math.sin(c)*(d/2+e/2),Math.cos(c)*(d/2+e/2),a.xaxis,a.yaxis);n.lineWidth=e/2;b(a.datapoints,Math.sin(c)*(d/2+e/4),Math.cos(c)*(d/2+e/4),a.xaxis,a.yaxis)}n.lineWidth=d;n.strokeStyle=a.color;if(e=S(a.lines,a.color,
0,V))n.fillStyle=e,k(a.datapoints,a.xaxis,a.yaxis);0<d&&b(a.datapoints,0,0,a.xaxis,a.yaxis);n.restore()}function J(a){function b(a,l,d,e,k,c,f,h){var m=a.points;a=a.pointsize;for(var g=0;g<m.length;g+=a){var z=m[g],s=m[g+1];null==z||(z<c.min||z>c.max||s<f.min||s>f.max)||(n.beginPath(),z=c.p2c(z),s=f.p2c(s)+e,"circle"==h?n.arc(z,s,l,0,k?Math.PI:2*Math.PI,!1):h(n,z,s,l,k),n.closePath(),d&&(n.fillStyle=d,n.fill()),n.stroke())}}n.save();n.translate(v.left,v.top);var d=a.points.lineWidth,e=a.shadowSize,
c=a.points.radius,f=a.points.symbol;0==d&&(d=1E-4);0<d&&0<e&&(e/=2,n.lineWidth=e,n.strokeStyle="rgba(0,0,0,0.1)",b(a.datapoints,c,null,e+e/2,!0,a.xaxis,a.yaxis,f),n.strokeStyle="rgba(0,0,0,0.2)",b(a.datapoints,c,null,e/2,!0,a.xaxis,a.yaxis,f));n.lineWidth=d;n.strokeStyle=a.color;b(a.datapoints,c,S(a.points,a.color),0,!1,a.xaxis,a.yaxis,f);n.restore()}function ea(a,b,d,e,c,f,h,m,g,p,n,q){var x,r,v,J;n?(J=r=v=!0,x=!1,n=d,d=b+e,c=b+c,a<n&&(b=a,a=n,n=b,x=!0,r=!1)):(x=r=v=!0,J=!1,n=a+e,a+=c,c=d,d=b,d<
c&&(b=d,d=c,c=b,J=!0,v=!1));a<m.min||(n>m.max||d<g.min||c>g.max)||(n<m.min&&(n=m.min,x=!1),a>m.max&&(a=m.max,r=!1),c<g.min&&(c=g.min,J=!1),d>g.max&&(d=g.max,v=!1),n=m.p2c(n),c=g.p2c(c),a=m.p2c(a),d=g.p2c(d),h&&(p.beginPath(),p.moveTo(n,c),p.lineTo(n,d),p.lineTo(a,d),p.lineTo(a,c),p.fillStyle=h(c,d),p.fill()),0<q&&(x||r||v||J)&&(p.beginPath(),p.moveTo(n,c+f),x?p.lineTo(n,d+f):p.moveTo(n,d+f),v?p.lineTo(a,d+f):p.moveTo(a,d+f),r?p.lineTo(a,c+f):p.moveTo(a,c+f),J?p.lineTo(n,c+f):p.moveTo(n,c+f),p.stroke()))}
function ra(a){n.save();n.translate(v.left,v.top);n.lineWidth=a.bars.lineWidth;n.strokeStyle=a.color;var b;switch(a.bars.align){case "left":b=0;break;case "right":b=-a.bars.barWidth;break;case "center":b=-a.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+a.bars.align);}(function(b,d,e,c,f,h,m){var g=b.points;b=b.pointsize;for(var z=0;z<g.length;z+=b)null!=g[z]&&ea(g[z],g[z+1],g[z+2],d,e,c,f,h,m,n,a.bars.horizontal,a.bars.lineWidth)})(a.datapoints,b,b+a.bars.barWidth,0,a.bars.fill?
function(b,d){return S(a.bars,a.color,b,d)}:null,a.xaxis,a.yaxis);n.restore()}function S(a,b,e,c){var f=a.fill;if(!f)return null;if(a.fillColor)return oa(a.fillColor,e,c,b);a=d.color.parse(b);a.a="number"==typeof f?f:0.4;a.normalize();return a.toString()}function B(){a.find(".legend").remove();if(m.legend.show){for(var b=[],c=[],k=!1,f=m.legend.labelFormatter,h,g,p=0;p<F.length;++p)h=F[p],h.label&&(g=f?f(h.label,h):h.label)&&c.push({label:g,color:h.color});if(m.legend.sorted)if(d.isFunction(m.legend.sorted))c.sort(m.legend.sorted);
else if("reverse"==m.legend.sorted)c.reverse();else{var n="descending"!=m.legend.sorted;c.sort(function(a,b){return a.label==b.label?0:a.label<b.label!=n?1:-1})}for(p=0;p<c.length;++p)f=c[p],0==p%m.legend.noColumns&&(k&&b.push("</tr>"),b.push("<tr>"),k=!0),b.push('<td class="legendColorBox"><div style="border:1px solid '+m.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+f.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+f.label+"</td>");
k&&b.push("</tr>");0!=b.length&&(c='<table style="font-size:smaller;color:'+m.grid.color+'">'+b.join("")+"</table>",null!=m.legend.container?d(m.legend.container).html(c):(b="",k=m.legend.position,p=m.legend.margin,null==p[0]&&(p=[p,p]),"n"==k.charAt(0)?b+="top:"+(p[1]+v.top)+"px;":"s"==k.charAt(0)&&(b+="bottom:"+(p[1]+v.bottom)+"px;"),"e"==k.charAt(1)?b+="right:"+(p[0]+v.right)+"px;":"w"==k.charAt(1)&&(b+="left:"+(p[0]+v.left)+"px;"),c=d('<div class="legend">'+c.replace('style="','style="position:absolute;'+
b+";")+"</div>").appendTo(a),0!=m.legend.backgroundOpacity&&(k=m.legend.backgroundColor,null==k&&(k=(k=m.grid.backgroundColor)&&"string"==typeof k?d.color.parse(k):d.color.extract(c,"background-color"),k.a=1,k=k.toString()),p=c.children(),d('<div style="position:absolute;width:'+p.width()+"px;height:"+p.height()+"px;"+b+"background-color:"+k+';"> </div>').prependTo(c).css("opacity",m.legend.backgroundOpacity))))}}function pa(a){m.grid.hoverable&&Z("plothover",a,function(a){return!1!=a.hoverable})}
function X(a){m.grid.hoverable&&Z("plothover",a,function(a){return!1})}function qa(a){Z("plotclick",a,function(a){return!1!=a.clickable})}function Z(b,d,c){var f=$.offset(),h=d.pageX-f.left-v.left,g=d.pageY-f.top-v.top,p=t({left:h,top:g});p.pageX=d.pageX;p.pageY=d.pageY;d=m.grid.mouseActiveRadius;var n=d*d+1,u=null,q,x,r;for(q=F.length-1;0<=q;--q)if(c(F[q])){var J=F[q],y=J.xaxis,w=J.yaxis,B=J.datapoints.points,K=y.c2p(h),H=w.c2p(g),ea=d/y.scale,E=d/w.scale;r=J.datapoints.pointsize;y.options.inverseTransform&&
(ea=Number.MAX_VALUE);w.options.inverseTransform&&(E=Number.MAX_VALUE);if(J.lines.show||J.points.show)for(x=0;x<B.length;x+=r){var R=B[x],O=B[x+1];null==R||(R-K>ea||R-K<-ea||O-H>E||O-H<-E)||(R=Math.abs(y.p2c(R)-h),O=Math.abs(w.p2c(O)-g),O=R*R+O*O,O<n&&(n=O,u=[q,x/r]))}if(J.bars.show&&!u)for(y="left"==J.bars.align?0:-J.bars.barWidth/2,J=y+J.bars.barWidth,x=0;x<B.length;x+=r)R=B[x],O=B[x+1],w=B[x+2],null!=R&&(F[q].bars.horizontal?K<=Math.max(w,R)&&K>=Math.min(w,R)&&H>=O+y&&H<=O+J:K>=R+y&&K<=R+J&&H>=
Math.min(w,O)&&H<=Math.max(w,O))&&(u=[q,x/r])}u?(q=u[0],x=u[1],r=F[q].datapoints.pointsize,c={datapoint:F[q].datapoints.points.slice(x*r,(x+1)*r),dataIndex:x,series:F[q],seriesIndex:q}):c=null;c&&(c.pageX=parseInt(c.series.xaxis.p2c(c.datapoint[0])+f.left+v.left,10),c.pageY=parseInt(c.series.yaxis.p2c(c.datapoint[1])+f.top+v.top,10));if(m.grid.autoHighlight){for(f=0;f<aa.length;++f)h=aa[f],h.auto!=b||c&&h.series==c.series&&h.point[0]==c.datapoint[0]&&h.point[1]==c.datapoint[1]||ia(h.series,h.point);
c&&ja(c.series,c.datapoint,b)}a.trigger(b,[p,c])}function fa(){var a=m.interaction.redrawOverlayInterval;-1==a?ka():ha||(ha=setTimeout(ka,a))}function ka(){ha=null;T.save();ga.clear();T.translate(v.left,v.top);var a,b;for(a=0;a<aa.length;++a)if(b=aa[a],b.series.bars.show)na(b.series,b.point);else{var c=b.series,e=b.point;b=e[0];var e=e[1],h=c.xaxis,g=c.yaxis,m="string"===typeof c.highlightColor?c.highlightColor:d.color.parse(c.color).scale("a",0.5).toString();if(!(b<h.min||b>h.max||e<g.min||e>g.max)){var p=
c.points.radius+c.points.lineWidth/2;T.lineWidth=p;T.strokeStyle=m;m=1.5*p;b=h.p2c(b);e=g.p2c(e);T.beginPath();"circle"==c.points.symbol?T.arc(b,e,m,0,2*Math.PI,!1):c.points.symbol(T,b,e,m,!1);T.closePath();T.stroke()}}T.restore();f(U.drawOverlay,[T])}function ja(a,b,d){"number"==typeof a&&(a=F[a]);if("number"==typeof b){var c=a.datapoints.pointsize;b=a.datapoints.points.slice(c*b,c*(b+1))}c=la(a,b);-1==c?(aa.push({series:a,point:b,auto:d}),fa()):d||(aa[c].auto=!1)}function ia(a,b){if(null==a&&null==
b)aa=[],fa();else{"number"==typeof a&&(a=F[a]);if("number"==typeof b){var d=a.datapoints.pointsize;b=a.datapoints.points.slice(d*b,d*(b+1))}d=la(a,b);-1!=d&&(aa.splice(d,1),fa())}}function la(a,b){for(var d=0;d<aa.length;++d){var c=aa[d];if(c.series==a&&c.point[0]==b[0]&&c.point[1]==b[1])return d}return-1}function na(a,b){var c="string"===typeof a.highlightColor?a.highlightColor:d.color.parse(a.color).scale("a",0.5).toString(),e="left"==a.bars.align?0:-a.bars.barWidth/2;T.lineWidth=a.bars.lineWidth;
T.strokeStyle=c;ea(b[0],b[1],b[2]||0,e,e+a.bars.barWidth,0,function(){return c},a.xaxis,a.yaxis,T,a.bars.horizontal,a.bars.lineWidth)}function oa(a,b,c,e){if("string"==typeof a)return a;b=n.createLinearGradient(0,c,0,b);c=0;for(var f=a.colors.length;c<f;++c){var h=a.colors[c];if("string"!=typeof h){var g=d.color.parse(e);null!=h.brightness&&(g=g.scale("rgb",h.brightness));null!=h.opacity&&(g.a*=h.opacity);h=g.toString()}b.addColorStop(c/(f-1),h)}return b}var F=[],m={colors:["#edc240","#afd8f8","#cb4b4b",
"#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,
minTickSize:null},yaxis:{autoscaleMargin:0.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,
markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1E3/60},hooks:{}},L=null,ga=null,$=null,n=null,T=null,P=[],W=[],v={left:0,right:0,top:0,bottom:0},Y=0,V=0,U={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},G=this;G.setData=g;G.setupGrid=w;G.draw=p;G.getPlaceholder=function(){return a};
G.getCanvas=function(){return L.element};G.getPlotOffset=function(){return v};G.width=function(){return Y};G.height=function(){return V};G.offset=function(){var a=$.offset();a.left+=v.left;a.top+=v.top;return a};G.getData=function(){return F};G.getAxes=function(){var a={};d.each(P.concat(W),function(b,d){d&&(a[d.direction+(1!=d.n?d.n:"")+"axis"]=d)});return a};G.getXAxes=function(){return P};G.getYAxes=function(){return W};G.c2p=t;G.p2c=function(a){var b={},d,c,e;for(d=0;d<P.length;++d)if((c=P[d])&&
c.used&&(e="x"+c.n,null==a[e]&&1==c.n&&(e="x"),null!=a[e])){b.left=c.p2c(a[e]);break}for(d=0;d<W.length;++d)if((c=W[d])&&c.used&&(e="y"+c.n,null==a[e]&&1==c.n&&(e="y"),null!=a[e])){b.top=c.p2c(a[e]);break}return b};G.getOptions=function(){return m};G.highlight=ja;G.unhighlight=ia;G.triggerRedrawOverlay=fa;G.pointOffset=function(a){return{left:parseInt(P[r(a,"x")-1].p2c(+a.x)+v.left,10),top:parseInt(W[r(a,"y")-1].p2c(+a.y)+v.top,10)}};G.shutdown=function(){ha&&clearTimeout(ha);$.unbind("mousemove",
pa);$.unbind("mouseleave",X);$.unbind("click",qa);f(U.shutdown,[$])};G.resize=function(){var b=a.width(),d=a.height();L.resize(b,d);ga.resize(b,d)};G.hooks=U;(function(){for(var a={Canvas:C},b=0;b<h.length;++b){var c=h[b];c.init(G,a);c.options&&d.extend(!0,m,c.options)}})(G);(function(b){d.extend(!0,m,b);null==m.xaxis.color&&(m.xaxis.color=d.color.parse(m.grid.color).scale("a",0.22).toString());null==m.yaxis.color&&(m.yaxis.color=d.color.parse(m.grid.color).scale("a",0.22).toString());null==m.xaxis.tickColor&&
(m.xaxis.tickColor=m.grid.tickColor||m.xaxis.color);null==m.yaxis.tickColor&&(m.yaxis.tickColor=m.grid.tickColor||m.yaxis.color);null==m.grid.borderColor&&(m.grid.borderColor=m.grid.color);null==m.grid.tickColor&&(m.grid.tickColor=d.color.parse(m.grid.color).scale("a",0.22).toString());var c,k,h={style:a.css("font-style"),size:Math.round(0.8*(+a.css("font-size").replace("px","")||13)),variant:a.css("font-variant"),weight:a.css("font-weight"),family:a.css("font-family")};h.lineHeight=1.15*h.size;k=
m.xaxes.length||1;for(b=0;b<k;++b)(c=m.xaxes[b])&&!c.tickColor&&(c.tickColor=c.color),c=d.extend(!0,{},m.xaxis,c),m.xaxes[b]=c,c.font&&(c.font=d.extend({},h,c.font),c.font.color||(c.font.color=c.color));k=m.yaxes.length||1;for(b=0;b<k;++b)(c=m.yaxes[b])&&!c.tickColor&&(c.tickColor=c.color),c=d.extend(!0,{},m.yaxis,c),m.yaxes[b]=c,c.font&&(c.font=d.extend({},h,c.font),c.font.color||(c.font.color=c.color));m.xaxis.noTicks&&null==m.xaxis.ticks&&(m.xaxis.ticks=m.xaxis.noTicks);m.yaxis.noTicks&&null==
m.yaxis.ticks&&(m.yaxis.ticks=m.yaxis.noTicks);m.x2axis&&(m.xaxes[1]=d.extend(!0,{},m.xaxis,m.x2axis),m.xaxes[1].position="top");m.y2axis&&(m.yaxes[1]=d.extend(!0,{},m.yaxis,m.y2axis),m.yaxes[1].position="right");m.grid.coloredAreas&&(m.grid.markings=m.grid.coloredAreas);m.grid.coloredAreasColor&&(m.grid.markingsColor=m.grid.coloredAreasColor);m.lines&&d.extend(!0,m.series.lines,m.lines);m.points&&d.extend(!0,m.series.points,m.points);m.bars&&d.extend(!0,m.series.bars,m.bars);null!=m.shadowSize&&
(m.series.shadowSize=m.shadowSize);null!=m.highlightColor&&(m.series.highlightColor=m.highlightColor);for(b=0;b<m.xaxes.length;++b)y(P,b+1).options=m.xaxes[b];for(b=0;b<m.yaxes.length;++b)y(W,b+1).options=m.yaxes[b];for(var g in U)m.hooks[g]&&m.hooks[g].length&&(U[g]=U[g].concat(m.hooks[g]));f(U.processOptions,[m])})(b);(function(){a.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove();"static"==a.css("position")&&a.css("position","relative");L=new C("flot-base",a);ga=new C("flot-overlay",
a);n=L.context;T=ga.context;$=d(ga.element).unbind();var b=a.data("plot");b&&(b.shutdown(),ga.clear());a.data("plot",G)})();g(c);w();p();m.grid.hoverable&&($.mousemove(pa),$.bind("mouseleave",X));m.grid.clickable&&$.click(qa);f(U.bindEvents,[$]);var aa=[],ha=null}var a=Object.prototype.hasOwnProperty;C.prototype.resize=function(a,c){if(0>=a||0>=c)throw Error("Invalid dimensions for plot, width = "+a+", height = "+c);var b=this.element,d=this.context,f=this.pixelRatio;this.width!=a&&(b.width=a*f,b.style.width=
a+"px",this.width=a);this.height!=c&&(b.height=c*f,b.style.height=c+"px",this.height=c);d.restore();d.save();d.scale(f,f)};C.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};C.prototype.render=function(){var d=this._textCache,c;for(c in d)if(a.call(d,c)){var b=this.getTextLayer(c),h=d[c];b.hide();for(var f in h)if(a.call(h,f)){var g=h[f],r;for(r in g)if(a.call(g,r)){var q=g[r];q.active?q.rendered||(b.append(q.element),q.rendered=!0):(delete g[r],q.rendered&&q.element.detach())}}b.show()}};
C.prototype.getTextLayer=function(a){var c=this.text[a];null==c&&(null==this.textContainer&&(this.textContainer=d("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),c=this.text[a]=d("<div></div>").addClass(a).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer));return c};C.prototype.getTextInfo=function(a,c,b,h){var f,g;c=""+c;h="object"===typeof b?b.style+" "+
b.variant+" "+b.weight+" "+b.size+"px/"+b.lineHeight+"px "+b.family:b;f=this._textCache[a];null==f&&(f=this._textCache[a]={});g=f[h];null==g&&(g=f[h]={});f=g[c];null==f&&(a=d("<div></div>").html(c).css({position:"absolute",top:-9999}).appendTo(this.getTextLayer(a)),"object"===typeof b?a.css({font:h,color:b.color}):"string"===typeof b&&a.addClass(b),f=g[c]={active:!1,rendered:!1,element:a,width:a.outerWidth(!0),height:a.outerHeight(!0)},a.detach());return f};C.prototype.addText=function(a,d,b,h,f,
g,r,q){a=this.getTextInfo(a,h,f,g);a.active=!0;"center"==r?d-=a.width/2:"right"==r&&(d-=a.width);"middle"==q?b-=a.height/2:"bottom"==q&&(b-=a.height);a.element.css({top:Math.round(b),left:Math.round(d)})};C.prototype.removeText=function(d,c,b,h){if(null==c){if(d=this._textCache[d],null!=d)for(var f in d)if(a.call(d,f)){c=d[f];for(var g in c)a.call(c,g)&&(c[g].active=!1)}}else this.getTextInfo(d,c,b,h).active=!1};d.plot=function(a,c,b){return new D(d(a),c,b,d.plot.plugins)};d.plot.version="0.8.0";
d.plot.plugins=[];d.fn.plot=function(a,c){return this.each(function(){d.plot(this,a,c)})}})(jQuery);
(function(d){var C=10,D=0.95,a={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:0.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(a,d){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+d.color+";'>"+a+"<br/>"+Math.round(d.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:0.5}}}};d.plot.plugins.push({init:function(e){function c(b){for(var c=
0,e=0,f=0,h=a.series.pie.combine.color,g=[],q=0;q<b.length;++q){var r=b[q].data;d.isArray(r)?d.isNumeric(r[1])?r[1]=+r[1]:r[1]=0:r=d.isNumeric(r)?[1,+r]:[1,0];b[q].data=[r]}for(q=0;q<b.length;++q)c+=b[q].data[0][1];for(q=0;q<b.length;++q)r=b[q].data[0][1],r/c<=a.series.pie.combine.threshold&&(e+=r,f++,h||(h=b[q].color));for(q=0;q<b.length;++q)r=b[q].data[0][1],(2>f||r/c>a.series.pie.combine.threshold)&&g.push({data:[[1,r]],color:b[q].color,label:b[q].label,angle:2*r*Math.PI/c,percent:r/(c/100)});
1<f&&g.push({data:[[1,e]],color:h,label:a.series.pie.combine.label,angle:2*e*Math.PI/c,percent:e/(c/100)});return g}function b(b,c){function e(){w.clearRect(0,0,q,r);y.children().filter(".pieLabel, .pieLabelBackground").remove()}function f(){var b=a.series.pie.shadow.left,d=a.series.pie.shadow.top,c=a.series.pie.shadow.alpha,e=1<a.series.pie.radius?a.series.pie.radius:H*a.series.pie.radius;if(!(e>=q/2-b||e*a.series.pie.tilt>=r/2-d||10>=e)){w.save();w.translate(b,d);w.globalAlpha=c;w.fillStyle="#000";
w.translate(E,ba);w.scale(1,a.series.pie.tilt);for(b=1;10>=b;b++)w.beginPath(),w.arc(0,0,e,0,2*Math.PI,!1),w.fill(),e-=b;w.restore()}}function g(){function b(a,d,c){0>=a||isNaN(a)||(c?w.fillStyle=d:(w.strokeStyle=d,w.lineJoin="round"),w.beginPath(),1E-9<Math.abs(a-2*Math.PI)&&w.moveTo(0,0),w.arc(0,0,f,p,p+a/2,!1),w.arc(0,0,f,p+a/2,p+a,!1),w.closePath(),p+=a,c?w.fill():w.stroke())}function c(){for(var b=e,f=1<a.series.pie.label.radius?a.series.pie.label.radius:H*a.series.pie.label.radius,h=0;h<S.length;++h){if(S[h].percent>=
100*a.series.pie.label.threshold){var g;g=S[h];var p=b,x=h;if(0==g.data[0][1])g=!0;else{var t=a.legend.labelFormatter,m=void 0,w=a.series.pie.label.formatter,m=t?t(g.label,g):g.label;w&&(m=w(m,g));t=(p+g.angle+p)/2;p=E+Math.round(Math.cos(t)*f);t=ba+Math.round(Math.sin(t)*f)*a.series.pie.tilt;y.append("<span class='pieLabel' id='pieLabel"+x+"' style='position:absolute;top:"+t+"px;left:"+p+"px;'>"+m+"</span>");x=y.children("#pieLabel"+x);m=t-x.height()/2;t=p-x.width()/2;x.css("top",m);x.css("left",
t);0<0-m||0<0-t||0>r-(m+x.height())||0>q-(t+x.width())?g=!1:(0!=a.series.pie.label.background.opacity&&(p=a.series.pie.label.background.color,null==p&&(p=g.color),g="top:"+m+"px;left:"+t+"px;",d("<div class='pieLabelBackground' style='position:absolute;width:"+x.width()+"px;height:"+x.height()+"px;"+g+"background-color:"+p+";'></div>").css("opacity",a.series.pie.label.background.opacity).insertBefore(x)),g=!0)}if(!g)return!1}b+=S[h].angle}return!0}var e=Math.PI*a.series.pie.startAngle,f=1<a.series.pie.radius?
a.series.pie.radius:H*a.series.pie.radius;w.save();w.translate(E,ba);w.scale(1,a.series.pie.tilt);w.save();for(var p=e,x=0;x<S.length;++x)S[x].startAngle=p,b(S[x].angle,S[x].color,!0);w.restore();if(0<a.series.pie.stroke.width){w.save();w.lineWidth=a.series.pie.stroke.width;p=e;for(x=0;x<S.length;++x)b(S[x].angle,a.series.pie.stroke.color,!1);w.restore()}h(w);w.restore();return a.series.pie.label.show?c():!0}if(y){var q=b.getPlaceholder().width(),r=b.getPlaceholder().height(),t=y.children().filter(".legend").children().width()||
0;w=c;N=!1;H=Math.min(q,r/a.series.pie.tilt)/2;ba=r/2+a.series.pie.offset.top;E=q/2;E="auto"==a.series.pie.offset.left?a.legend.position.match("w")?E+t/2:E-t/2:E+a.series.pie.offset.left;E<H?E=H:E>q-H&&(E=q-H);var S=b.getData(),t=0;do 0<t&&(H*=D),t+=1,e(),0.8>=a.series.pie.tilt&&f();while(!g()&&t<C);t>=C&&(e(),y.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>"));b.setSeries&&b.insertLegend&&(b.setSeries(S),b.insertLegend())}}function h(b){if(0<a.series.pie.innerRadius){b.save();
var d=1<a.series.pie.innerRadius?a.series.pie.innerRadius:H*a.series.pie.innerRadius;b.globalCompositeOperation="destination-out";b.beginPath();b.fillStyle=a.series.pie.stroke.color;b.arc(0,0,d,0,2*Math.PI,!1);b.fill();b.closePath();b.restore();b.save();b.beginPath();b.strokeStyle=a.series.pie.stroke.color;b.arc(0,0,d,0,2*Math.PI,!1);b.stroke();b.closePath();b.restore()}}function f(a){r("plothover",a)}function g(a){r("plotclick",a)}function r(b,d){var c=e.offset(),f=parseInt(d.pageX-c.left);a:{for(var c=
parseInt(d.pageY-c.top),h=e.getData(),g=e.getOptions(),g=1<g.series.pie.radius?g.series.pie.radius:H*g.series.pie.radius,r,t,D=0;D<h.length;++D){var B=h[D];if(B.pie.show){w.save();w.beginPath();w.moveTo(0,0);w.arc(0,0,g,B.startAngle,B.startAngle+B.angle/2,!1);w.arc(0,0,g,B.startAngle+B.angle/2,B.startAngle+B.angle,!1);w.closePath();r=f-E;t=c-ba;if(w.isPointInPath){if(w.isPointInPath(f-E,c-ba)){w.restore();f={datapoint:[B.percent,B.data],dataIndex:0,series:B,seriesIndex:D};break a}}else{var C=g*Math.cos(B.startAngle),
X=g*Math.sin(B.startAngle),N=g*Math.cos(B.startAngle+B.angle/4),Z=g*Math.sin(B.startAngle+B.angle/4),fa=g*Math.cos(B.startAngle+B.angle/2),ka=g*Math.sin(B.startAngle+B.angle/2),ja=g*Math.cos(B.startAngle+B.angle/1.5),ia=g*Math.sin(B.startAngle+B.angle/1.5),la=g*Math.cos(B.startAngle+B.angle),na=g*Math.sin(B.startAngle+B.angle),C=[[0,0],[C,X],[N,Z],[fa,ka],[ja,ia],[la,na]];r=[r,t];t=!1;X=-1;N=C.length;for(Z=N-1;++X<N;Z=X)(C[X][1]<=r[1]&&r[1]<C[Z][1]||C[Z][1]<=r[1]&&r[1]<C[X][1])&&r[0]<(C[Z][0]-C[X][0])*
(r[1]-C[X][1])/(C[Z][1]-C[X][1])+C[X][0]&&(t=!t);if(t){w.restore();f={datapoint:[B.percent,B.data],dataIndex:0,series:B,seriesIndex:D};break a}}w.restore()}}f=null}if(a.grid.autoHighlight)for(c=0;c<Q.length;++c)h=Q[c],h.auto!=b||f&&h.series==f.series||(h=h.series,null==h&&(Q=[],e.triggerRedrawOverlay()),h=q(h),-1!=h&&(Q.splice(h,1),e.triggerRedrawOverlay()));f&&(c=f.series,h=q(c),-1==h?(Q.push({series:c,auto:b}),e.triggerRedrawOverlay()):b||(Q[h].auto=!1));y.trigger(b,[{pageX:d.pageX,pageY:d.pageY},
f])}function q(a){for(var b=0;b<Q.length;++b)if(Q[b].series==a)return b;return-1}var t=null,y=null,H=null,E=null,ba=null,N=!1,w=null,Q=[];e.hooks.processOptions.push(function(a,b){b.series.pie.show&&(b.grid.show=!1,"auto"==b.series.pie.label.show&&(b.series.pie.label.show=b.legend.show?!1:!0),"auto"==b.series.pie.radius&&(b.series.pie.radius=b.series.pie.label.show?0.75:1),1<b.series.pie.tilt?b.series.pie.tilt=1:0>b.series.pie.tilt&&(b.series.pie.tilt=0))});e.hooks.bindEvents.push(function(a,b){var d=
a.getOptions();d.series.pie.show&&(d.grid.hoverable&&b.unbind("mousemove").mousemove(f),d.grid.clickable&&b.unbind("click").click(g))});e.hooks.processDatapoints.push(function(b,e,f,h){b.getOptions().series.pie.show&&!N&&(N=!0,t=b.getCanvas(),y=d(t).parent(),a=b.getOptions(),b.setData(c(b.getData())))});e.hooks.drawOverlay.push(function(a,b){if(a.getOptions().series.pie.show){var d=a.getOptions(),c=1<d.series.pie.radius?d.series.pie.radius:H*d.series.pie.radius;b.save();b.translate(E,ba);b.scale(1,
d.series.pie.tilt);for(var e=0;e<Q.length;++e){var f=Q[e].series;0>=f.angle||isNaN(f.angle)||(b.fillStyle="rgba(255, 255, 255, "+d.series.pie.highlight.opacity+")",b.beginPath(),1E-9<Math.abs(f.angle-2*Math.PI)&&b.moveTo(0,0),b.arc(0,0,c,f.startAngle,f.startAngle+f.angle/2,!1),b.arc(0,0,c,f.startAngle+f.angle/2,f.startAngle+f.angle,!1),b.closePath(),b.fill())}h(b);b.restore()}});e.hooks.draw.push(function(a,d){a.getOptions().series.pie.show&&b(a,d)})},options:a,name:"pie",version:"1.1"})})(jQuery);
(function(d,C){var D=0;d.widget("s3.pivottable",{options:{showTotals:!0,ajaxURL:null,defaultChart:{type:"breakdown",axis:"rows"},renderFilter:!0,renderOptions:!0,renderChart:!0,renderTable:!0,collapseFilter:!1,collapseOptions:!0,collapseChart:!0,collapseTable:!1},_create:function(){this.id=D;D+=1;this.chart=this.table=null},_init:function(){var a=this.element;this.table=this.data=null;this.chart_options={currentChart:null,currentDataIndex:null,currentSeriesIndex:null};this.table_options={hidden:!1};
var e=d(a).find(".pt-chart");this.chart=e.length?e.first():null;this.options.renderFilter||this.options.renderOptions?(e=d(a).attr("id"),this.options.renderOptions?(d("#"+e+"-options").show(),this.options.collapseOptions&&(d("#"+e+"-options legend").siblings().toggle(),d("#"+e+"-options legend").children().toggle())):d("#"+e+"-options").hide(),this.options.renderFilter?(d("#"+e+"-filters").show(),this.options.collapseFilter&&(d("#"+e+"-filters legend").siblings().toggle(),d("#"+e+"-filters legend").children().toggle())):
d("#"+e+"-options").hide()):d(a).find(".pt-form-container").hide();this.options.collapseTable&&(this.table_options.hidden=!0,d(a).find(".pt-table").hide(),d(a).find(".pt-show-table").show(),d(a).find(".pt-hide-table").hide());this.refresh()},_destroy:function(){this.table&&this.table.remove();this.chart&&this.chart.empty()},refresh:function(){var a=this.element,e=null;this._unbindEvents();var c=d(a).find('input[type="hidden"][name="pivotdata"]');c.length&&(e=JSON.parse(d(c).first().val()));e||(e=
{empty:!0},d(a).find(".pt-hide-table").hide(),d(a).find(".pt-show-table").hide());this.data=e;e.nodata?(d(a).find(".pt-table").first().empty().append(d('<div class="pt-no-data">'+e.nodata+"</div>")),d(a).find(".pt-hide-table").hide(),d(a).find(".pt-show-table").hide()):(this._renderTable(),this._renderChartOptions());this._renderChart();e.empty?d(a).find(".pt-empty").show():d(a).find(".pt-empty").hide();this._bindEvents();d(a).find(".pt-throbber").hide()},_renderTable:function(){var a=this.element,
e=d(a).find(".pt-table").first().empty();this.table=null;var c=this.data;if(!c.empty)if(this.options.renderTable){var b=c.cells,h=c.cols,f=c.rows,g=c.total,r=c.labels,c=this._renderHeader(h,r);c.append(this._renderColumns(h,r));b=this._renderRows(f,h,r,b);h=this._renderFooter(f,h,r,g);f=d('<table class="dataTable display report"/>').append(c).append(b);null!==h&&f.append(h);this.table=d(f);d(e).append(this.table);this.table_options.hidden?(d(a).find(".pt-show-table").show(),d(a).find(".pt-hide-table").hide()):
(d(a).find(".pt-show-table").hide(),d(a).find(".pt-hide-table").show())}else d(a).find(".pt-show-table").hide(),d(a).find(".pt-hide-table").hide()},_renderHeader:function(a,e){var c=d("<tr>");colspan="__other__"==a[a.length-1][0]?a.length-1:a.length;c.append(d('<th scope="col">'+e.layer+"</th>"));(1<a.length||a[0][4])&&c.append(d('<th scope="col" colspan="'+colspan+'">'+e.cols+"</th>"));this.options.showTotals&&c.append(d('<th class="totals_header row_totals" scope="col" rowspan="2">'+e.total+"</th>"));
return d("<thead>").append(c)},_renderColumns:function(a,e){var c=d("<tr>"),b;c.append(d('<th scope="col">'+e.rows+"</th>"));for(var h=1==a.length&&null===a[0][4]?!0:!1,f=0;f<a.length;f++)"__other__"==a[f][0]||h&&this.options.showTotals||(b=h?"":a[f][4],c.append(d('<th scope="col">'+b+"</th>")));return c},_renderRows:function(a,e,c,b){for(var h=d("<tbody>"),f=this.options.showTotals,g=1==a.length&&null===a[0][4]?!0:!1,r,q,t=0;t<b.length;t++)r=a[t],"__other__"==r[0]||g&&this.options.showTotals||(q=
g?"":a[t][4],q=d('<tr class="'+(t%2?"odd":"even")+'"><td>'+q+"</td></tr>").append(this._renderCells(b[t],e,c)),f&&q.append(d("<td>"+r[2]+"</td>")),h.append(q));return h},_renderCells:function(a,e,c){for(var b,h=c.none,f=1==e.length&&null===e[0][4]?!0:!1,g=[],r,q,t=0;t<a.length;t++)if(!("__other__"==e[t][0]||f&&this.options.showTotals)){b=a[t];c=b.items;r=d("<td>");if(null===c)q=d('<div class="pt-cell-value">'+h+"</div>");else if(d.isArray(c)){q=d('<div class="pt-cell-value">');list=d("<ul>");for(var y=
0;y<c.length;y++)list.append(d("<li>"+c[y]+"</li>"));q.append(list)}else q=d('<div class="pt-cell-value">'+c+"</div>");r.append(q);b=b.keys;c&&(b&&b.length)&&r.data("records",b).append(d('<div class="pt-cell-zoom"></div>'));g.push(r)}return g},_renderFooter:function(a,e,c,b){var h=1==e.length&&null===e[0][4]?!0:!1;if(this.options.showTotals){var f,g;g=f=0;for(len=a.length;f<len;f++)"__other__"!=a[f][0]&&g++;a=d('<tr class="'+(g%2?"odd":"even")+' totals_row"><th class="totals_header" scope="row">'+
c.total+"</th></tr>");for(f=0;f<e.length;f++)"__other__"==e[f][0]||h||a.append(d("<td>"+e[f][2]+"</td>"));a.append(d("<td>"+b+"</td>"));return d("<tfoot>").append(a)}return null},_renderChartOptions:function(){var a=this.element,e=d(a).find(".pt-chart-controls").first().empty(),c=this.data;if(!c.empty&&this.options.renderChart){var c=c.labels,b=d(a).attr("id"),a=c.layer,h=c.rows,f=c.cols,g=c.per,r=d('<div class="pt-chart-opts">'),q=b+"-pchart-rows",t=b+"-vchart-rows",y=b+"-hchart-rows",H=b+"-pchart-cols",
E=b+"-vchart-cols",b=b+"-hchart-cols";a&&d(r).append(d('<span class="pt-chart-label">'+a+"</span>"));h&&d(r).append(d('<div id="'+q+'" class="pt-chart-icon pt-pchart"/><div id="'+t+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+g+" "+h+"</span>"));f&&d(r).append(d('<div id="'+H+'" class="pt-chart-icon pt-pchart"/><div id="'+E+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+g+" "+f+"</span>"));h&&f&&d(r).append(d('<span class="pt-chart-label">| '+c.breakdown+
'</span><div id="'+y+'" class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+[g,h,"&amp;",f].join(" ")+'</span><div id="'+b+'"  class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+[g,f,"&amp;",h].join(" ")+"</span>"));d(e).append(r)}},_renderChart:function(a){var e=this.data;d(this.element).find(".pt-chart-contents").hide();var c=this.chart;if(c&&(d(c).unbind("plothover").unbind("plotclick").empty(),!e.empty&&this.options.renderChart))if(!1===a)this.options.collapseChart=!0;
else{c=this.options.collapseChart;if("undefined"==typeof a||!a){if(c)return;a=this.chart_options.currentChart}if("undefined"==typeof a||!a){if(c)return;a=this.options.defaultChart}if("undefined"!=typeof a&&a){this.options.collapseChart=!1;this.chart_options.currentChart=a;c=a.type;a=a.axis;var b=e.labels,h=b.per,f=b.layer+" "+h+" "+b.rows,b=b.layer+" "+h+" "+b.cols,h=e.filter,g=h[0],r=h[1],q=h[2];"piechart"==c?"rows"==a?this._renderPieChart(e.rows,f,g,r):this._renderPieChart(e.cols,b,g,q):"barchart"==
c?"rows"==a?this._renderBarChart(e.rows,f,g,r):this._renderBarChart(e.cols,b,g,q):"breakdown"==c&&("rows"==a?this._renderBreakDown(e,0,f,h):this._renderBreakDown(e,1,b,h))}}},_renderPieChart:function(a,e,c,b){var h=this.chart;if(h){d(h).closest(".pt-chart-contents").show().css({width:"800px"});d(h).css({height:"360px"});for(var f=[],g=0;g<a.length;g++){var r=a[g];r[1]||f.push({label:r[4],data:r[2],key:r[3]})}e?d(h).siblings(".pt-chart-title").html("<h4>"+e+"</h4>"):d(h).siblings(".pt-chart-title").empty();
reportChart=jQuery.plot(d(h),f,{series:{pie:{show:!0,radius:125}},legend:{show:!0,position:"ne"},grid:{hoverable:!0,clickable:!0}});var q=this;this.chart_options.currentDataIndex=null;d(h).bind("plothover",function(a,b,c){if(c){if(q.chart_options.currentDataIndex!=c.seriesIndex){q._removeChartTooltip();q.chart_options.currentDataIndex=c.seriesIndex;a=c.series.data[0][1];var e=c.series.percent.toFixed(1),f='<div class="pt-tooltip-label">'+c.series.label+"</div>";q._renderChartTooltip(b.pageX,b.pageY,
f+('<div class="pt-tooltip-text">'+a+" ("+e+"%)</div>"));d(".pt-tooltip-label").css({color:c.series.color})}}else q._removeChartTooltip()});c&&b&&d(h).bind("plotclick",function(a,d,e){if(e){a={};try{a[b]=f[e.seriesIndex].key}catch(h){return}e=q._updateURL(c,a);window.open(e,"_blank")}})}},_renderBarChart:function(a,e,c,b){var h=this.chart;if(h){d(h).closest(".pt-chart-contents").show().css({width:"96%"});d(h).css({height:"360px"});for(var f=[],g=[],r=0,q=0;q<a.length;q++){var t=a[q];t[1]||(f.push({label:t[4],
data:[[r+1,t[2]]],key:t[3]}),g.push([r+1,t[4]]),r++)}e?d(h).siblings(".pt-chart-title").html("<h4>"+e+"</h4>"):d(h).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(h),f,{series:{bars:{show:!0,barWidth:0.6,align:"center"}},legend:{show:!1,position:"ne"},grid:{hoverable:!0,clickable:!0},xaxis:{ticks:g,min:0,max:f.length+1,tickLength:0}});var y=this;this.chart_options.currentDataIndex=null;d(h).bind("plothover",function(a,b,c){c?y.chart_options.currentDataIndex!=c.seriesIndex&&(y._removeChartTooltip(),
y.chart_options.currentDataIndex=c.seriesIndex,a='<div class="pt-tooltip-label">'+c.series.label+"</div>",a+='<div class="pt-tooltip-text">'+c.series.data[0][1]+"</div>",y._renderChartTooltip(b.pageX,b.pageY,a),d(".pt-tooltip-label").css({color:c.series.color})):y._removeChartTooltip()});c&&b&&d(h).bind("plotclick",function(a,d,e){if(e){a={};try{a[b]=f[e.seriesIndex].key}catch(h){return}e=y._updateURL(c,a);window.open(e,"_blank")}})}},_renderBreakDown:function(a,e,c,b){var h=this.chart;if(h){d(h).closest(".pt-chart-contents").show().css({width:"96%"});
var f=b[0],g,r,q=a.cells,t,y=[],D=[];0===e?(e=a.rows,t=a.cols,a=function(a,b){return q[y[a]][D[b]].value},g=b[1],r=b[2]):(e=a.cols,t=a.rows,a=function(a,b){return q[D[b]][y[a]].value},g=b[2],r=b[1]);var E=[],C=[];b=0;for(len=e.length;b<len;b++)e[b][1]||(E.push(e[b]),y.push(b));b=0;for(len=t.length;b<len;b++)t[b][1]||(C.push(t[b]),D.push(b));b=Math.max(E.length*Math.max(16*(C.length+1),50)+70,360);d(h).css({height:b+"px"});b=[];for(var N=e=0;N<C.length;N++){for(var w={label:C[N][4]},Q=[],p,x=0;x<E.length;x++)t=
(E.length-x)*(C.length+1)-N,p=a(x,N),p>e&&(e=p),Q.push([p,t]);w.data=Q;b.push(w)}a=[];for(x=0;x<E.length;x++)N=E[x][4],t=(E.length-x)*(C.length+1)+1,a.push([t,N]);c?d(h).siblings(".pt-chart-title").html("<h4>"+c+"</h4>"):d(h).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(h),b,{series:{bars:{show:!0,barWidth:0.8,align:"center",horizontal:!0}},legend:{show:!0,position:"ne"},yaxis:{ticks:a,labelWidth:120,max:E.length*(C.length+1)+1},xaxis:{max:1.1*e},grid:{hoverable:!0,clickable:!0}});
d(".flot-y-axis .tickLabel").css({"padding-top":"20px",left:"0px",width:"120px"});var K=this;this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null;d(h).bind("plothover",function(a,b,c){if(c){if(K.chart_options.currentDataIndex!=c.dataIndex||K.chart_options.currentSeriesIndex!=c.seriesIndex)K._removeChartTooltip(),K.chart_options.currentDataIndex=c.dataIndex,K.chart_options.currentSeriesIndex=c.seriesIndex,a='<div class="pt-tooltip-label">'+E[c.dataIndex][4]+"</div>",
a+='<div class="pt-tooltip-text">'+c.series.label+' : <span class="pt-tooltip-value">'+c.datapoint[0]+"</span></div>",K._renderChartTooltip(b.pageX,b.pageY,a),d(".pt-tooltip-label").css({"padding-bottom":"8px"}),d(".pt-tooltip-text").css({color:c.series.color}),d(".pt-tooltip-value").css({"font-weight":"bold"})}else K._removeChartTooltip()});f&&(g&&r)&&d(h).bind("plotclick",function(a,b,c){if(c){a={};try{a[g]=E[c.dataIndex][3],a[r]=C[c.seriesIndex][3]}catch(d){return}c=K._updateURL(f,a);window.open(c,
"_blank")}})}},_renderChartTooltip:function(a,e,c){d('<div class="pt-chart-tooltip">'+c+"</div>").css({position:"absolute",display:"none",top:e-50,left:a+10,border:"1px solid #999",padding:"10px","min-height":"50px","max-width":"240px","z-index":"501","background-color":"white",color:"#000",opacity:0.95}).appendTo("body").fadeIn(200)},_removeChartTooltip:function(){d(".pt-chart-tooltip").remove();this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null},_getOptions:function(){var a=
"#"+d(this.element).attr("id");return{rows:d(a+"-rows").val(),cols:d(a+"-cols").val(),fact:d(a+"-fact").val(),totals:d(a+"-totals").is(":checked")?1:0}},_getFilters:function(){var a="#"+d(this.element).attr("id"),a=d(a+"-filters");try{return a.length?S3.search.getCurrentFilters(a.first()):null}catch(e){}},_updateURL:function(a,d){var c=a.split("?"),b={};if(1<c.length){var h=c[1].split("&"),f,g,r;g=0;for(r=h.length;g<r;g++)f=h[g].split("="),1<f.length&&(b[decodeURIComponent(f[0])]=decodeURIComponent(f[1]))}if(d)for(option in d)newopt=
d[option],b[option]=newopt?newopt:null;h=[];for(option in b)null!==b[option]&&h.push(option+"="+b[option]);b=h.join("&");c=c[0];b&&(c=c+"?"+b);return c},_updateAjaxURL:function(a,e){var c=this.options.ajaxURL.split("?"),b=null,b=[];needs_reload=!1;var h;1<c.length?(h=c[1],h=h.split("&")):h=[];var f,g;if(a)for(f in a)newopt=a[f],g=f+"="+newopt,"totals"==f?this.options.showTotals=newopt?!0:!1:needs_reload||-1!=d.inArray(g,h)||(needs_reload=!0),b.push(g);f={};var r={},q,t,y;if(e)for(q=0,t=e.length;q<
t;q++)g=e[q],y=g[0],g=g[1],null===g?f[y]||(r[y]=!0):(r[y]&&(r[y]=!1),f[y]?f[y].push(y+"="+g):f[y]=[y+"="+g]);q=0;for(t=h.length;q<t;q++)g=h[q].split("="),1<g.length&&(y=decodeURIComponent(g[0]),g=decodeURIComponent(g[1]),r[y]?needs_reload=!0:f[y]?needs_reload||-1!=d.inArray(y+"="+g,f[y])||(needs_reload=!0):"aggregate"!=y&&(a&&a.hasOwnProperty(y)||b.push(h[q])));for(y in f)for(q=0,t=f[y].length;q<t;q++)needs_reload||-1!=d.inArray(f[y][q],h)||(needs_reload=!0),b.push(f[y][q]);b=b.join("&");c=c[0];b&&
(c=c+"?"+b);this.options.ajaxURL=c;return needs_reload},reload:function(a,e,c){c="undefined"!=typeof c?c:!0;"undefined"==typeof e&&(e=this._getFilters());var b=this,h=this.element,f,g=d(h).find('input[type="hidden"][name="pivotdata"]');if(g.length){if(a||e)f=this._updateAjaxURL(a,e);f||c?(a=this.options.ajaxURL,d(h).find(".pt-throbber").show(),d.ajax({url:a,dataType:"json"}).done(function(a){g.first().val(JSON.stringify(a));b.refresh()}).fail(function(a,b,c){msg="UNAUTHORIZED"==c?i18n.gis_requires_login:
a.responseText;console.log(msg)})):(d(h).find(".pt-throbber").show(),b.refresh())}},_bindEvents:function(a){var e=this,c=this.element;a=this.data;var b=d(c).attr("id");d("#"+b+"-options legend").click(function(){d(this).siblings().toggle();d(this).children().toggle()});d("#"+b+"-filters legend").click(function(){d(this).siblings().toggle();d(this).children().toggle()});d(c).find(".pt-hide-table").click(function(){e.table_options.hidden=!0;d(c).find(".pt-table").hide();d(this).siblings(".pt-show-table").show();
d(this).hide()});d(c).find(".pt-show-table").click(function(){e.table_options.hidden=!1;d(c).find(".pt-table").show();d(this).siblings(".pt-hide-table").show();d(this).hide()});d("#"+b+"-totals").click(function(){var a=d(this).is(":checked");e.options.showTotals!=a&&e.reload({totals:a},null,!1)});d(c).find("input.pt-submit").click(function(){var a=e._getOptions(),b=e._getFilters();e.reload(a,b,!1)});d("#"+b+" div.pt-table div.pt-cell-zoom").click(function(b){b=d(b.currentTarget);var c=b.closest("td"),
e=c.find(".pt-cell-records");if(0<e.length)e.remove(),b.removeClass("opened");else{for(var r=c.data("records"),e=d("<div/>").addClass("pt-cell-records"),q=d("<ul/>"),t=0;t<r.length;t++)q.append("<li>"+a.lookup[r[t]]+"</li>");e.append(q);c.append(e);b.addClass("opened")}});d("#"+b+"-pchart-rows").click(function(){e._renderChart({type:"piechart",axis:"rows"})});d("#"+b+"-vchart-rows").click(function(){e._renderChart({type:"barchart",axis:"rows"})});d("#"+b+"-pchart-cols").click(function(){e._renderChart({type:"piechart",
axis:"cols"})});d("#"+b+"-vchart-cols").click(function(){e._renderChart({type:"barchart",axis:"cols"})});d("#"+b+"-hchart-rows").click(function(){e._renderChart({type:"breakdown",axis:"rows"})});d("#"+b+"-hchart-cols").click(function(){e._renderChart({type:"breakdown",axis:"cols"})});d(c).find(".pt-hide-chart").click(function(){e._renderChart(!1)})},_unbindEvents:function(){var a=this.element,e=d(a).attr("id");d(a).find("input.pt-submit").unbind("click");d("#"+e+" div.pt-table div.pt-cell-zoom").unbind("click");
d("#"+e+"-options legend").unbind("click");d("#"+e+"-filters legend").unbind("click");d(e+"-totals").unbind("click");d("#"+e+"-pchart-rows").unbind("click");d("#"+e+"-vchart-rows").unbind("click");d("#"+e+"-pchart-cols").unbind("click");d("#"+e+"-vchart-cols").unbind("click");d(a).find(".pt-hide-table").unbind("click");d(a).find(".pt-show-table").unbind("click");d(a).find(".pt-hide-chart").unbind("click")}})})(jQuery);
