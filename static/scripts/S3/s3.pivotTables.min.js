/*
: 2013 (c) Sahana Software Foundation
 @license: MIT

 requires: jQuery 1.9.1+
 requires: jQuery UI 1.10 widget factory

*/
(function(d){d.color={};d.color.make=function(r,c,a,e){var b={};b.r=r||0;b.g=c||0;b.b=a||0;b.a=null!=e?e:1;b.add=function(a,d){for(var c=0;c<a.length;++c)b[a.charAt(c)]+=d;return b.normalize()};b.scale=function(a,d){for(var c=0;c<a.length;++c)b[a.charAt(c)]*=d;return b.normalize()};b.toString=function(){return 1<=b.a?"rgb("+[b.r,b.g,b.b].join()+")":"rgba("+[b.r,b.g,b.b,b.a].join()+")"};b.normalize=function(){function a(d,b,c){return b<d?d:b>c?c:b}b.r=a(0,parseInt(b.r),255);b.g=a(0,parseInt(b.g),255);
b.b=a(0,parseInt(b.b),255);b.a=a(0,b.a,1);return b};b.clone=function(){return d.color.make(b.r,b.b,b.g,b.a)};return b.normalize()};d.color.extract=function(r,c){var a;do{a=r.css(c).toLowerCase();if(""!=a&&"transparent"!=a)break;r=r.parent()}while(!d.nodeName(r.get(0),"body"));"rgba(0, 0, 0, 0)"==a&&(a="transparent");return d.color.parse(a)};d.color.parse=function(s){var c,a=d.color.make;if(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(s))return a(parseInt(c[1],10),parseInt(c[2],
10),parseInt(c[3],10));if(c=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(s))return a(parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10),parseFloat(c[4]));if(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(s))return a(2.55*parseFloat(c[1]),2.55*parseFloat(c[2]),2.55*parseFloat(c[3]));if(c=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(s))return a(2.55*
parseFloat(c[1]),2.55*parseFloat(c[2]),2.55*parseFloat(c[3]),parseFloat(c[4]));if(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(s))return a(parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16));if(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(s))return a(parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16));s=d.trim(s).toLowerCase();if("transparent"==s)return a(255,255,255,0);c=r[s]||[0,0,0];return a(c[0],c[1],c[2])};var r={aqua:[0,255,255],azure:[240,255,255],beige:[245,
245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,
144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
(function(d){function r(a,c){var b=c.children("."+a)[0];if(null==b&&(b=document.createElement("canvas"),b.className=a,d(b).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(c),!b.getContext))if(window.G_vmlCanvasManager)b=window.G_vmlCanvasManager.initElement(b);else throw Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=
b;b=this.context=b.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1);this.resize(c.width(),c.height());this.textContainer=null;this.text={};this._textCache={}}function s(a,c,b,f){function m(l,x){x=[G].concat(x);for(var h=0;h<l.length;++h)l[h].apply(this,x)}function k(l){for(var x=[],h=0;h<l.length;++h){var a=d.extend(!0,{},n.series);null!=l[h].data?
(a.data=l[h].data,delete l[h].data,d.extend(!0,a,l[h]),l[h].data=a.data):a.data=l[h];x.push(a)}C=x;h=C.length;x=-1;for(l=0;l<C.length;++l)a=C[l].color,null!=a&&(h--,"number"==typeof a&&a>x&&(x=a));h<=x&&(h=x+1);var x=[],b=n.colors,c=b.length,B=0;for(l=0;l<h;l++)a=d.color.parse(b[l%c]||"#666"),0==l%c&&l&&(B=0<=B?.5>B?-B-.2:0:-B),x[l]=a.scale("rgb",1+B);for(l=h=0;l<C.length;++l){a=C[l];null==a.color?(a.color=x[h].toString(),++h):"number"==typeof a.color&&(a.color=x[a.color].toString());if(null==a.lines.show){var e,
b=!0;for(e in a)if(a[e]&&a[e].show){b=!1;break}b&&(a.lines.show=!0)}null==a.lines.zero&&(a.lines.zero=!!a.lines.fill);a.xaxis=v(N,g(a,"x"));a.yaxis=v(T,g(a,"y"))}F()}function g(l,x){var h=l[x+"axis"];"object"==typeof h&&(h=h.n);"number"!=typeof h&&(h=1);return h}function p(){return d.grep(N.concat(T),function(l){return l})}function E(l){var x={},h,a;for(h=0;h<N.length;++h)(a=N[h])&&a.used&&(x["x"+a.n]=a.c2p(l.left));for(h=0;h<T.length;++h)(a=T[h])&&a.used&&(x["y"+a.n]=a.c2p(l.top));void 0!==x.x1&&
(x.x=x.x1);void 0!==x.y1&&(x.y=x.y1);return x}function v(l,a){l[a-1]||(l[a-1]={n:a,direction:l==N?"x":"y",options:d.extend(!0,{},l==N?n.xaxis:n.yaxis)});return l[a-1]}function F(){function l(l,h,a){h<l.datamin&&h!=-b&&(l.datamin=h);a>l.datamax&&a!=b&&(l.datamax=a)}var a=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,b=Number.MAX_VALUE,c,L,B,e,u,I,Q,n,q,f,k,g;d.each(p(),function(l,b){b.datamin=a;b.datamax=h;b.used=!1});for(c=0;c<C.length;++c)u=C[c],u.datapoints={points:[]},m(R.processRawData,
[u,u.data,u.datapoints]);for(c=0;c<C.length;++c){u=C[c];k=u.data;g=u.datapoints.format;if(!g){g=[];g.push({x:!0,number:!0,required:!0});g.push({y:!0,number:!0,required:!0});if(u.bars.show||u.lines.show&&u.lines.fill)g.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:!!(u.bars.show&&u.bars.zero||u.lines.show&&u.lines.zero)}),u.bars.horizontal&&(delete g[g.length-1].y,g[g.length-1].x=!0);u.datapoints.format=g}if(null==u.datapoints.pointsize){u.datapoints.pointsize=g.length;Q=u.datapoints.pointsize;
I=u.datapoints.points;var ba=u.lines.show&&u.lines.steps;u.xaxis.used=u.yaxis.used=!0;for(L=B=0;L<k.length;++L,B+=Q){f=k[L];var E=null==f;if(!E)for(e=0;e<Q;++e){n=f[e];if(q=g[e])q.number&&null!=n&&(n=+n,isNaN(n)?n=null:Infinity==n?n=b:-Infinity==n&&(n=-b)),null==n&&(q.required&&(E=!0),null!=q.defaultValue&&(n=q.defaultValue));I[B+e]=n}if(E)for(e=0;e<Q;++e)n=I[B+e],null!=n&&(q=g[e],q.autoscale&&(q.x&&l(u.xaxis,n,n),q.y&&l(u.yaxis,n,n))),I[B+e]=null;else if(ba&&0<B&&null!=I[B-Q]&&I[B-Q]!=I[B]&&I[B-
Q+1]!=I[B+1]){for(e=0;e<Q;++e)I[B+Q+e]=I[B+e];I[B+1]=I[B-Q+1];B+=Q}}}}for(c=0;c<C.length;++c)u=C[c],m(R.processDatapoints,[u,u.datapoints]);for(c=0;c<C.length;++c){u=C[c];I=u.datapoints.points;Q=u.datapoints.pointsize;g=u.datapoints.format;f=B=a;ba=k=h;for(L=0;L<I.length;L+=Q)if(null!=I[L])for(e=0;e<Q;++e)n=I[L+e],(q=g[e])&&!1!==q.autoscale&&n!=b&&n!=-b&&(q.x&&(n<B&&(B=n),n>k&&(k=n)),q.y&&(n<f&&(f=n),n>ba&&(ba=n)));if(u.bars.show){switch(u.bars.align){case "left":L=0;break;case "right":L=-u.bars.barWidth;
break;case "center":L=-u.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+u.bars.align);}u.bars.horizontal?(f+=L,ba+=L+u.bars.barWidth):(B+=L,k+=L+u.bars.barWidth)}l(u.xaxis,B,k);l(u.yaxis,f,ba)}d.each(p(),function(l,b){b.datamin==a&&(b.datamin=null);b.datamax==h&&(b.datamax=null)})}function s(l){function a(l){return l}var h,b,c=l.options.transform||a,d=l.options.inverseTransform;"x"==l.direction?(h=l.scale=U/Math.abs(c(l.max)-c(l.min)),b=Math.min(c(l.max),c(l.min))):(h=l.scale=
S/Math.abs(c(l.max)-c(l.min)),h=-h,b=Math.max(c(l.max),c(l.min)));l.p2c=c==a?function(l){return(l-b)*h}:function(l){return(c(l)-b)*h};l.c2p=d?function(l){return d(b+l/h)}:function(l){return b+l/h}}function t(l){var a=l.labelWidth,h=l.labelHeight,b=l.options.position,c=l.options.tickLength,e=n.grid.axisMargin,B=n.grid.labelMargin,m="x"==l.direction?N:T,u,I=d.grep(m,function(l){return l&&l.options.position==b&&l.reserveSpace});d.inArray(l,I)==I.length-1&&(e=0);null==c&&(c=d.grep(m,function(l){return l&&
l.reserveSpace}),c=(u=0==d.inArray(l,c))?"full":5);isNaN(+c)||(B+=+c);"x"==l.direction?(h+=B,"bottom"==b?(w.bottom+=h+e,l.box={top:K.height-w.bottom,height:h}):(l.box={top:w.top+e,height:h},w.top+=h+e)):(a+=B,"left"==b?(l.box={left:w.left+e,width:a},w.left+=a+e):(w.right+=a+e,l.box={left:K.width-w.right,width:a}));l.position=b;l.tickLength=c;l.box.padding=B;l.innermost=u}function O(){var l=n.grid.minBorderMargin,a={x:0,y:0},h;if(null==l)for(h=l=0;h<C.length;++h)l=Math.max(l,2*(C[h].points.radius+
C[h].points.lineWidth/2));a.x=a.y=Math.ceil(l);d.each(p(),function(l,h){var b=h.direction;h.reserveSpace&&(a[b]=Math.ceil(Math.max(a[b],("x"==b?h.labelWidth:h.labelHeight)/2)))});w.left=Math.max(a.x,w.left);w.right=Math.max(a.x,w.right);w.top=Math.max(a.y,w.top);w.bottom=Math.max(a.y,w.bottom)}function z(){var l,a=p(),h=n.grid.show;for(l in w){var b=n.grid.margin||0;w[l]="number"==typeof b?b:b[l]||0}m(R.processOffset,[w]);for(l in w)w[l]="object"==typeof n.grid.borderWidth?w[l]+(h?n.grid.borderWidth[l]:
0):w[l]+(h?n.grid.borderWidth:0);d.each(a,function(l,a){a.show=a.options.show;null==a.show&&(a.show=a.used);a.reserveSpace=a.show||a.options.reserveSpace;var h=a.options,b=+(null!=h.min?h.min:a.datamin),c=+(null!=h.max?h.max:a.datamax),x=c-b;if(0==x){if(x=0==c?1:.01,null==h.min&&(b-=x),null==h.max||null!=h.min)c+=x}else{var d=h.autoscaleMargin;null!=d&&(null==h.min&&(b-=x*d,0>b&&null!=a.datamin&&0<=a.datamin&&(b=0)),null==h.max&&(c+=x*d,0<c&&null!=a.datamax&&0>=a.datamax&&(c=0)))}a.min=b;a.max=c});
if(h){b=d.grep(a,function(l){return l.reserveSpace});d.each(b,function(l,a){A(a);var h=a.options.ticks,b=[];null==h||"number"==typeof h&&0<h?b=a.tickGenerator(a):h&&(b=d.isFunction(h)?h(a):h);var c;a.ticks=[];for(h=0;h<b.length;++h){var x=null,e=b[h];"object"==typeof e?(c=+e[0],1<e.length&&(x=e[1])):c=+e;null==x&&(x=a.tickFormatter(c,a));isNaN(c)||a.ticks.push({v:c,label:x})}b=a.ticks;a.options.autoscaleMargin&&0<b.length&&(null==a.options.min&&(a.min=Math.min(a.min,b[0].v)),null==a.options.max&&
1<b.length&&(a.max=Math.max(a.max,b[b.length-1].v)));b=a.options;h=a.ticks||[];c=b.labelWidth||0;x=b.labelHeight||0;e=c||"x"==a.direction?Math.floor(K.width/(h.length||1)):null;legacyStyles=a.direction+"Axis "+a.direction+a.n+"Axis";layer="flot-"+a.direction+"-axis flot-"+a.direction+a.n+"-axis "+legacyStyles;font=b.font||"flot-tick-label tickLabel";for(var n=0;n<h.length;++n){var D=h[n];D.label&&(D=K.getTextInfo(layer,D.label,font,null,e),c=Math.max(c,D.width),x=Math.max(x,D.height))}a.labelWidth=
b.labelWidth||c;a.labelHeight=b.labelHeight||x});for(l=b.length-1;0<=l;--l)t(b[l]);O();d.each(b,function(l,a){"x"==a.direction?(a.box.left=w.left-a.labelWidth/2,a.box.width=K.width-w.left-w.right+a.labelWidth):(a.box.top=w.top-a.labelHeight/2,a.box.height=K.height-w.bottom-w.top+a.labelHeight)})}U=K.width-w.left-w.right;S=K.height-w.bottom-w.top;d.each(a,function(l,a){s(a)});h&&fa();V()}function A(l){var a=l.options,h;h="number"==typeof a.ticks&&0<a.ticks?a.ticks:.3*Math.sqrt("x"==l.direction?K.width:
K.height);h=(l.max-l.min)/h;var b=-Math.floor(Math.log(h)/Math.LN10),c=a.tickDecimals;null!=c&&b>c&&(b=c);var e=Math.pow(10,-b),n=h/e,m;1.5>n?m=1:3>n?(m=2,2.25<n&&(null==c||b+1<=c)&&(m=2.5,++b)):m=7.5>n?5:10;m*=e;null!=a.minTickSize&&m<a.minTickSize&&(m=a.minTickSize);l.delta=h;l.tickDecimals=Math.max(0,null!=c?c:b);l.tickSize=a.tickSize||m;if("time"==a.mode&&!l.tickGenerator)throw Error("Time mode requires the flot.time plugin.");l.tickGenerator||(l.tickGenerator=function(l){var a=[],h;h=l.tickSize;
h*=Math.floor(l.min/h);var b=0,c=Number.NaN,x;do x=c,c=h+b*l.tickSize,a.push(c),++b;while(c<l.max&&c!=x);return a},l.tickFormatter=function(l,a){var h=a.tickDecimals?Math.pow(10,a.tickDecimals):1,b=""+Math.round(l*h)/h;if(null!=a.tickDecimals){var c=b.indexOf("."),c=-1==c?0:b.length-c-1;if(c<a.tickDecimals)return(c?b:b+".")+(""+h).substr(1,a.tickDecimals-c)}return b});d.isFunction(a.tickFormatter)&&(l.tickFormatter=function(l,h){return""+a.tickFormatter(l,h)});if(null!=a.alignTicksWithAxis){var u=
("x"==l.direction?N:T)[a.alignTicksWithAxis-1];u&&u.used&&u!=l&&(h=l.tickGenerator(l),0<h.length&&(null==a.min&&(l.min=Math.min(l.min,h[0])),null==a.max&&1<h.length&&(l.max=Math.max(l.max,h[h.length-1]))),l.tickGenerator=function(l){var a=[],h,b;for(b=0;b<u.ticks.length;++b)h=(u.ticks[b].v-u.min)/(u.max-u.min),h=l.min+h*(l.max-l.min),a.push(h);return a},l.mode||null!=a.tickDecimals||(h=Math.max(0,-Math.floor(Math.log(l.delta)/Math.LN10)+1),b=l.tickGenerator(l),1<b.length&&/\..*0$/.test((b[1]-b[0]).toFixed(h))||
(l.tickDecimals=h)))}}function J(){K.clear();m(R.drawBackground,[q]);var l=n.grid;l.show&&l.backgroundColor&&(q.save(),q.translate(w.left,w.top),q.fillStyle=na(n.grid.backgroundColor,S,0,"rgba(255, 255, 255, 0)"),q.fillRect(0,0,U,S),q.restore());l.show&&!l.aboveData&&oa();for(var a=0;a<C.length;++a){m(R.drawSeries,[q,C[a]]);var h=C[a];h.lines.show&&aa(h);h.bars.show&&y(h);h.points.show&&H(h)}m(R.draw,[q]);l.show&&l.aboveData&&oa();K.render();ca()}function W(l,a){for(var h,b,c,d,e=p(),n=0;n<e.length;++n)if(h=
e[n],h.direction==a&&(d=a+h.n+"axis",l[d]||1!=h.n||(d=a+"axis"),l[d])){b=l[d].from;c=l[d].to;break}l[d]||(h="x"==a?N[0]:T[0],b=l[a+"1"],c=l[a+"2"]);null!=b&&null!=c&&b>c&&(d=b,b=c,c=d);return{from:b,to:c,axis:h}}function oa(){var l,a,h;q.save();q.translate(w.left,w.top);if(h=n.grid.markings)for(d.isFunction(h)&&(a=G.getAxes(),a.xmin=a.xaxis.min,a.xmax=a.xaxis.max,a.ymin=a.yaxis.min,a.ymax=a.yaxis.max,h=h(a)),l=0;l<h.length;++l){a=h[l];var b=W(a,"x"),c=W(a,"y");null==b.from&&(b.from=b.axis.min);null==
b.to&&(b.to=b.axis.max);null==c.from&&(c.from=c.axis.min);null==c.to&&(c.to=c.axis.max);b.to<b.axis.min||b.from>b.axis.max||c.to<c.axis.min||c.from>c.axis.max||(b.from=Math.max(b.from,b.axis.min),b.to=Math.min(b.to,b.axis.max),c.from=Math.max(c.from,c.axis.min),c.to=Math.min(c.to,c.axis.max),b.from==b.to&&c.from==c.to)||(b.from=b.axis.p2c(b.from),b.to=b.axis.p2c(b.to),c.from=c.axis.p2c(c.from),c.to=c.axis.p2c(c.to),b.from==b.to||c.from==c.to?(q.beginPath(),q.strokeStyle=a.color||n.grid.markingsColor,
q.lineWidth=a.lineWidth||n.grid.markingsLineWidth,q.moveTo(b.from,c.from),q.lineTo(b.to,c.to),q.stroke()):(q.fillStyle=a.color||n.grid.markingsColor,q.fillRect(b.from,c.to,b.to-b.from,c.from-c.to)))}a=p();h=n.grid.borderWidth;for(b=0;b<a.length;++b){c=a[b];l=c.box;var e=c.tickLength,m,g,u,f;if(c.show&&0!=c.ticks.length){q.lineWidth=1;"x"==c.direction?(m=0,g="full"==e?"top"==c.position?0:S:l.top-w.top+("top"==c.position?l.height:0)):(g=0,m="full"==e?"left"==c.position?0:U:l.left-w.left+("left"==c.position?
l.width:0));c.innermost||(q.strokeStyle=c.options.color,q.beginPath(),u=f=0,"x"==c.direction?u=U+1:f=S+1,1==q.lineWidth&&("x"==c.direction?g=Math.floor(g)+.5:m=Math.floor(m)+.5),q.moveTo(m,g),q.lineTo(m+u,g+f),q.stroke());q.strokeStyle=c.options.tickColor;q.beginPath();for(l=0;l<c.ticks.length;++l){var k=c.ticks[l].v;u=f=0;isNaN(k)||k<c.min||k>c.max||"full"==e&&("object"==typeof h&&0<h[c.position]||0<h)&&(k==c.min||k==c.max)||("x"==c.direction?(m=c.p2c(k),f="full"==e?-S:e,"top"==c.position&&(f=-f)):
(g=c.p2c(k),u="full"==e?-U:e,"left"==c.position&&(u=-u)),1==q.lineWidth&&("x"==c.direction?m=Math.floor(m)+.5:g=Math.floor(g)+.5),q.moveTo(m,g),q.lineTo(m+u,g+f))}q.stroke()}}h&&(l=n.grid.borderColor,"object"==typeof h||"object"==typeof l?("object"!==typeof h&&(h={top:h,right:h,bottom:h,left:h}),"object"!==typeof l&&(l={top:l,right:l,bottom:l,left:l}),0<h.top&&(q.strokeStyle=l.top,q.lineWidth=h.top,q.beginPath(),q.moveTo(0-h.left,0-h.top/2),q.lineTo(U,0-h.top/2),q.stroke()),0<h.right&&(q.strokeStyle=
l.right,q.lineWidth=h.right,q.beginPath(),q.moveTo(U+h.right/2,0-h.top),q.lineTo(U+h.right/2,S),q.stroke()),0<h.bottom&&(q.strokeStyle=l.bottom,q.lineWidth=h.bottom,q.beginPath(),q.moveTo(U+h.right,S+h.bottom/2),q.lineTo(0,S+h.bottom/2),q.stroke()),0<h.left&&(q.strokeStyle=l.left,q.lineWidth=h.left,q.beginPath(),q.moveTo(0-h.left/2,S+h.bottom),q.lineTo(0-h.left/2,0),q.stroke())):(q.lineWidth=h,q.strokeStyle=n.grid.borderColor,q.strokeRect(-h/2,-h/2,U+h,S+h)));q.restore()}function fa(){d.each(p(),
function(a,b){if(b.show&&0!=b.ticks.length){var c=b.box,d="flot-"+b.direction+"-axis flot-"+b.direction+b.n+"-axis "+(b.direction+"Axis "+b.direction+b.n+"Axis"),e=b.options.font||"flot-tick-label tickLabel",n,m,g,u,f;K.removeText(d);for(var q=0;q<b.ticks.length;++q)n=b.ticks[q],!n.label||n.v<b.min||n.v>b.max||("x"==b.direction?(u="center",m=w.left+b.p2c(n.v),"bottom"==b.position?g=c.top+c.padding:(g=c.top+c.height-c.padding,f="bottom")):(f="middle",g=w.top+b.p2c(n.v),"left"==b.position?(m=c.left+
c.width-c.padding,u="right"):m=c.left+c.padding),K.addText(d,m,g,n.label,e,null,null,u,f))}})}function aa(a){function b(a,l,c,h,d){var e=a.points;a=a.pointsize;var n=null,x=null;q.beginPath();for(var m=a;m<e.length;m+=a){var g=e[m-a],f=e[m-a+1],k=e[m],p=e[m+1];if(null!=g&&null!=k){if(f<=p&&f<d.min){if(p<d.min)continue;g=(d.min-f)/(p-f)*(k-g)+g;f=d.min}else if(p<=f&&p<d.min){if(f<d.min)continue;k=(d.min-f)/(p-f)*(k-g)+g;p=d.min}if(f>=p&&f>d.max){if(p>d.max)continue;g=(d.max-f)/(p-f)*(k-g)+g;f=d.max}else if(p>=
f&&p>d.max){if(f>d.max)continue;k=(d.max-f)/(p-f)*(k-g)+g;p=d.max}if(g<=k&&g<h.min){if(k<h.min)continue;f=(h.min-g)/(k-g)*(p-f)+f;g=h.min}else if(k<=g&&k<h.min){if(g<h.min)continue;p=(h.min-g)/(k-g)*(p-f)+f;k=h.min}if(g>=k&&g>h.max){if(k>h.max)continue;f=(h.max-g)/(k-g)*(p-f)+f;g=h.max}else if(k>=g&&k>h.max){if(g>h.max)continue;p=(h.max-g)/(k-g)*(p-f)+f;k=h.max}g==n&&f==x||q.moveTo(h.p2c(g)+l,d.p2c(f)+c);n=k;x=p;q.lineTo(h.p2c(k)+l,d.p2c(p)+c)}}q.stroke()}function c(a,l,b){var h=a.points;a=a.pointsize;
for(var d=Math.min(Math.max(0,b.min),b.max),e=0,n=!1,x=1,m=0,g=0;!(0<a&&e>h.length+a);){var e=e+a,f=h[e-a],k=h[e-a+x],p=h[e],D=h[e+x];if(n){if(0<a&&null!=f&&null==p){g=e;a=-a;x=2;continue}if(0>a&&e==m+a){q.fill();n=!1;a=-a;x=1;e=m=g+a;continue}}if(null!=f&&null!=p){if(f<=p&&f<l.min){if(p<l.min)continue;k=(l.min-f)/(p-f)*(D-k)+k;f=l.min}else if(p<=f&&p<l.min){if(f<l.min)continue;D=(l.min-f)/(p-f)*(D-k)+k;p=l.min}if(f>=p&&f>l.max){if(p>l.max)continue;k=(l.max-f)/(p-f)*(D-k)+k;f=l.max}else if(p>=f&&
p>l.max){if(f>l.max)continue;D=(l.max-f)/(p-f)*(D-k)+k;p=l.max}n||(q.beginPath(),q.moveTo(l.p2c(f),b.p2c(d)),n=!0);if(k>=b.max&&D>=b.max)q.lineTo(l.p2c(f),b.p2c(b.max)),q.lineTo(l.p2c(p),b.p2c(b.max));else if(k<=b.min&&D<=b.min)q.lineTo(l.p2c(f),b.p2c(b.min)),q.lineTo(l.p2c(p),b.p2c(b.min));else{var E=f,ma=p;k<=D&&k<b.min&&D>=b.min?(f=(b.min-k)/(D-k)*(p-f)+f,k=b.min):D<=k&&D<b.min&&k>=b.min&&(p=(b.min-k)/(D-k)*(p-f)+f,D=b.min);k>=D&&k>b.max&&D<=b.max?(f=(b.max-k)/(D-k)*(p-f)+f,k=b.max):D>=k&&D>b.max&&
k<=b.max&&(p=(b.max-k)/(D-k)*(p-f)+f,D=b.max);f!=E&&q.lineTo(l.p2c(E),b.p2c(k));q.lineTo(l.p2c(f),b.p2c(k));q.lineTo(l.p2c(p),b.p2c(D));p!=ma&&(q.lineTo(l.p2c(p),b.p2c(D)),q.lineTo(l.p2c(ma),b.p2c(D)))}}}}q.save();q.translate(w.left,w.top);q.lineJoin="round";var d=a.lines.lineWidth,e=a.shadowSize;if(0<d&&0<e){q.lineWidth=e;q.strokeStyle="rgba(0,0,0,0.1)";var n=Math.PI/18;b(a.datapoints,Math.sin(n)*(d/2+e/2),Math.cos(n)*(d/2+e/2),a.xaxis,a.yaxis);q.lineWidth=e/2;b(a.datapoints,Math.sin(n)*(d/2+e/4),
Math.cos(n)*(d/2+e/4),a.xaxis,a.yaxis)}q.lineWidth=d;q.strokeStyle=a.color;if(e=M(a.lines,a.color,0,S))q.fillStyle=e,c(a.datapoints,a.xaxis,a.yaxis);0<d&&b(a.datapoints,0,0,a.xaxis,a.yaxis);q.restore()}function H(a){function b(a,l,c,h,d,e,f,n){var x=a.points;a=a.pointsize;for(var k=0;k<x.length;k+=a){var m=x[k],g=x[k+1];null==m||m<e.min||m>e.max||g<f.min||g>f.max||(q.beginPath(),m=e.p2c(m),g=f.p2c(g)+h,"circle"==n?q.arc(m,g,l,0,d?Math.PI:2*Math.PI,!1):n(q,m,g,l,d),q.closePath(),c&&(q.fillStyle=c,
q.fill()),q.stroke())}}q.save();q.translate(w.left,w.top);var c=a.points.lineWidth,d=a.shadowSize,e=a.points.radius,f=a.points.symbol;0==c&&(c=1E-4);0<c&&0<d&&(d/=2,q.lineWidth=d,q.strokeStyle="rgba(0,0,0,0.1)",b(a.datapoints,e,null,d+d/2,!0,a.xaxis,a.yaxis,f),q.strokeStyle="rgba(0,0,0,0.2)",b(a.datapoints,e,null,d/2,!0,a.xaxis,a.yaxis,f));q.lineWidth=c;q.strokeStyle=a.color;b(a.datapoints,e,M(a.points,a.color),0,!1,a.xaxis,a.yaxis,f);q.restore()}function pa(a,b,c,d,e,f,n,k,m,g,p,q){var E,z,r,v;p?
(v=z=r=!0,E=!1,p=c,c=b+d,e=b+e,a<p&&(b=a,a=p,p=b,E=!0,z=!1)):(E=z=r=!0,v=!1,p=a+d,a+=e,e=c,c=b,c<e&&(b=c,c=e,e=b,v=!0,r=!1));a<k.min||p>k.max||c<m.min||e>m.max||(p<k.min&&(p=k.min,E=!1),a>k.max&&(a=k.max,z=!1),e<m.min&&(e=m.min,v=!1),c>m.max&&(c=m.max,r=!1),p=k.p2c(p),e=m.p2c(e),a=k.p2c(a),c=m.p2c(c),n&&(g.beginPath(),g.moveTo(p,e),g.lineTo(p,c),g.lineTo(a,c),g.lineTo(a,e),g.fillStyle=n(e,c),g.fill()),0<q&&(E||z||r||v)&&(g.beginPath(),g.moveTo(p,e+f),E?g.lineTo(p,c+f):g.moveTo(p,c+f),r?g.lineTo(a,
c+f):g.moveTo(a,c+f),z?g.lineTo(a,e+f):g.moveTo(a,e+f),v?g.lineTo(p,e+f):g.moveTo(p,e+f),g.stroke()))}function y(a){q.save();q.translate(w.left,w.top);q.lineWidth=a.bars.lineWidth;q.strokeStyle=a.color;var b;switch(a.bars.align){case "left":b=0;break;case "right":b=-a.bars.barWidth;break;case "center":b=-a.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+a.bars.align);}(function(b,c,d,e,f,n,g){var k=b.points;b=b.pointsize;for(var m=0;m<k.length;m+=b)null!=k[m]&&pa(k[m],k[m+1],k[m+
2],c,d,e,f,n,g,q,a.bars.horizontal,a.bars.lineWidth)})(a.datapoints,b,b+a.bars.barWidth,0,a.bars.fill?function(b,c){return M(a.bars,a.color,b,c)}:null,a.xaxis,a.yaxis);q.restore()}function M(a,b,c,e){var f=a.fill;if(!f)return null;if(a.fillColor)return na(a.fillColor,c,e,b);a=d.color.parse(b);a.a="number"==typeof f?f:.4;a.normalize();return a.toString()}function V(){a.find(".legend").remove();if(n.legend.show){for(var b=[],c=[],h=!1,e=n.legend.labelFormatter,f,k,g=0;g<C.length;++g)f=C[g],f.label&&
(k=e?e(f.label,f):f.label)&&c.push({label:k,color:f.color});if(n.legend.sorted)if(d.isFunction(n.legend.sorted))c.sort(n.legend.sorted);else if("reverse"==n.legend.sorted)c.reverse();else{var m="descending"!=n.legend.sorted;c.sort(function(a,b){return a.label==b.label?0:a.label<b.label!=m?1:-1})}for(g=0;g<c.length;++g)e=c[g],0==g%n.legend.noColumns&&(h&&b.push("</tr>"),b.push("<tr>"),h=!0),b.push('<td class="legendColorBox"><div style="border:1px solid '+n.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+
e.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+e.label+"</td>");h&&b.push("</tr>");0!=b.length&&(c='<table style="font-size:smaller;color:'+n.grid.color+'">'+b.join("")+"</table>",null!=n.legend.container?d(n.legend.container).html(c):(b="",h=n.legend.position,g=n.legend.margin,null==g[0]&&(g=[g,g]),"n"==h.charAt(0)?b+="top:"+(g[1]+w.top)+"px;":"s"==h.charAt(0)&&(b+="bottom:"+(g[1]+w.bottom)+"px;"),"e"==h.charAt(1)?b+="right:"+(g[0]+w.right)+"px;":"w"==h.charAt(1)&&(b+="left:"+
(g[0]+w.left)+"px;"),c=d('<div class="legend">'+c.replace('style="','style="position:absolute;'+b+";")+"</div>").appendTo(a),0!=n.legend.backgroundOpacity&&(h=n.legend.backgroundColor,null==h&&(h=(h=n.grid.backgroundColor)&&"string"==typeof h?d.color.parse(h):d.color.extract(c,"background-color"),h.a=1,h=h.toString()),g=c.children(),d('<div style="position:absolute;width:'+g.width()+"px;height:"+g.height()+"px;"+b+"background-color:"+h+';"> </div>').prependTo(c).css("opacity",n.legend.backgroundOpacity))))}}
function da(a){n.grid.hoverable&&ga("plothover",a,function(a){return!1!=a.hoverable})}function Y(a){n.grid.hoverable&&ga("plothover",a,function(a){return!1})}function ia(a){ga("plotclick",a,function(a){return!1!=a.clickable})}function ga(b,c,h){var d=X.offset(),e=c.pageX-d.left-w.left,f=c.pageY-d.top-w.top,g=E({left:e,top:f});g.pageX=c.pageX;g.pageY=c.pageY;c=n.grid.mouseActiveRadius;var k=c*c+1,m=null,p,q,z;for(p=C.length-1;0<=p;--p)if(h(C[p])){var r=C[p],v=r.xaxis,t=r.yaxis,A=r.datapoints.points,
F=v.c2p(e),aa=t.c2p(f),fa=c/v.scale,J=c/t.scale;z=r.datapoints.pointsize;v.options.inverseTransform&&(fa=Number.MAX_VALUE);t.options.inverseTransform&&(J=Number.MAX_VALUE);if(r.lines.show||r.points.show)for(q=0;q<A.length;q+=z){var y=A[q],H=A[q+1];null==y||y-F>fa||y-F<-fa||H-aa>J||H-aa<-J||(y=Math.abs(v.p2c(y)-e),H=Math.abs(t.p2c(H)-f),H=y*y+H*H,H<k&&(k=H,m=[p,q/z]))}if(r.bars.show&&!m)for(v="left"==r.bars.align?0:-r.bars.barWidth/2,r=v+r.bars.barWidth,q=0;q<A.length;q+=z)y=A[q],H=A[q+1],t=A[q+2],
null!=y&&(C[p].bars.horizontal?F<=Math.max(t,y)&&F>=Math.min(t,y)&&aa>=H+v&&aa<=H+r:F>=y+v&&F<=y+r&&aa>=Math.min(t,H)&&aa<=Math.max(t,H))&&(m=[p,q/z])}m?(p=m[0],q=m[1],z=C[p].datapoints.pointsize,h={datapoint:C[p].datapoints.points.slice(q*z,(q+1)*z),dataIndex:q,series:C[p],seriesIndex:p}):h=null;h&&(h.pageX=parseInt(h.series.xaxis.p2c(h.datapoint[0])+d.left+w.left,10),h.pageY=parseInt(h.series.yaxis.p2c(h.datapoint[1])+d.top+w.top,10));if(n.grid.autoHighlight){for(d=0;d<Z.length;++d)e=Z[d],e.auto!=
b||h&&e.series==h.series&&e.point[0]==h.datapoint[0]&&e.point[1]==h.datapoint[1]||ja(e.series,e.point);h&&ka(h.series,h.datapoint,b)}a.trigger(b,[g,h])}function ca(){var a=n.interaction.redrawOverlayInterval;-1==a?la():ha||(ha=setTimeout(la,a))}function la(){ha=null;P.save();ea.clear();P.translate(w.left,w.top);var a,b;for(a=0;a<Z.length;++a)if(b=Z[a],b.series.bars.show)ra(b.series,b.point);else{var c=b.series,e=b.point;b=e[0];var e=e[1],f=c.xaxis,g=c.yaxis,k="string"===typeof c.highlightColor?c.highlightColor:
d.color.parse(c.color).scale("a",.5).toString();if(!(b<f.min||b>f.max||e<g.min||e>g.max)){var n=c.points.radius+c.points.lineWidth/2;P.lineWidth=n;P.strokeStyle=k;k=1.5*n;b=f.p2c(b);e=g.p2c(e);P.beginPath();"circle"==c.points.symbol?P.arc(b,e,k,0,2*Math.PI,!1):c.points.symbol(P,b,e,k,!1);P.closePath();P.stroke()}}P.restore();m(R.drawOverlay,[P])}function ka(a,b,c){"number"==typeof a&&(a=C[a]);if("number"==typeof b){var e=a.datapoints.pointsize;b=a.datapoints.points.slice(e*b,e*(b+1))}e=qa(a,b);-1==
e?(Z.push({series:a,point:b,auto:c}),ca()):c||(Z[e].auto=!1)}function ja(a,b){if(null==a&&null==b)Z=[],ca();else{"number"==typeof a&&(a=C[a]);if("number"==typeof b){var c=a.datapoints.pointsize;b=a.datapoints.points.slice(c*b,c*(b+1))}c=qa(a,b);-1!=c&&(Z.splice(c,1),ca())}}function qa(a,b){for(var c=0;c<Z.length;++c){var e=Z[c];if(e.series==a&&e.point[0]==b[0]&&e.point[1]==b[1])return c}return-1}function ra(a,b){var c="string"===typeof a.highlightColor?a.highlightColor:d.color.parse(a.color).scale("a",
.5).toString(),e="left"==a.bars.align?0:-a.bars.barWidth/2;P.lineWidth=a.bars.lineWidth;P.strokeStyle=c;pa(b[0],b[1],b[2]||0,e,e+a.bars.barWidth,0,function(){return c},a.xaxis,a.yaxis,P,a.bars.horizontal,a.bars.lineWidth)}function na(a,b,c,e){if("string"==typeof a)return a;b=q.createLinearGradient(0,c,0,b);c=0;for(var f=a.colors.length;c<f;++c){var g=a.colors[c];if("string"!=typeof g){var k=d.color.parse(e);null!=g.brightness&&(k=k.scale("rgb",g.brightness));null!=g.opacity&&(k.a*=g.opacity);g=k.toString()}b.addColorStop(c/
(f-1),g)}return b}var C=[],n={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,
alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,
margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1E3/60},hooks:{}},K=null,ea=null,X=null,q=null,P=null,N=[],T=[],w={left:0,right:0,top:0,bottom:0},U=0,S=0,R={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},G=this;
G.setData=k;G.setupGrid=z;G.draw=J;G.getPlaceholder=function(){return a};G.getCanvas=function(){return K.element};G.getPlotOffset=function(){return w};G.width=function(){return U};G.height=function(){return S};G.offset=function(){var a=X.offset();a.left+=w.left;a.top+=w.top;return a};G.getData=function(){return C};G.getAxes=function(){var a={};d.each(N.concat(T),function(b,c){c&&(a[c.direction+(1!=c.n?c.n:"")+"axis"]=c)});return a};G.getXAxes=function(){return N};G.getYAxes=function(){return T};G.c2p=
E;G.p2c=function(a){var b={},c,e,d;for(c=0;c<N.length;++c)if((e=N[c])&&e.used&&(d="x"+e.n,null==a[d]&&1==e.n&&(d="x"),null!=a[d])){b.left=e.p2c(a[d]);break}for(c=0;c<T.length;++c)if((e=T[c])&&e.used&&(d="y"+e.n,null==a[d]&&1==e.n&&(d="y"),null!=a[d])){b.top=e.p2c(a[d]);break}return b};G.getOptions=function(){return n};G.highlight=ka;G.unhighlight=ja;G.triggerRedrawOverlay=ca;G.pointOffset=function(a){return{left:parseInt(N[g(a,"x")-1].p2c(+a.x)+w.left,10),top:parseInt(T[g(a,"y")-1].p2c(+a.y)+w.top,
10)}};G.shutdown=function(){ha&&clearTimeout(ha);X.unbind("mousemove",da);X.unbind("mouseleave",Y);X.unbind("click",ia);m(R.shutdown,[X])};G.resize=function(){var b=a.width(),c=a.height();K.resize(b,c);ea.resize(b,c)};G.hooks=R;(function(){for(var a={Canvas:r},b=0;b<f.length;++b){var c=f[b];c.init(G,a);c.options&&d.extend(!0,n,c.options)}})(G);(function(b){d.extend(!0,n,b);b&&b.colors&&(n.colors=b.colors);null==n.xaxis.color&&(n.xaxis.color=d.color.parse(n.grid.color).scale("a",.22).toString());null==
n.yaxis.color&&(n.yaxis.color=d.color.parse(n.grid.color).scale("a",.22).toString());null==n.xaxis.tickColor&&(n.xaxis.tickColor=n.grid.tickColor||n.xaxis.color);null==n.yaxis.tickColor&&(n.yaxis.tickColor=n.grid.tickColor||n.yaxis.color);null==n.grid.borderColor&&(n.grid.borderColor=n.grid.color);null==n.grid.tickColor&&(n.grid.tickColor=d.color.parse(n.grid.color).scale("a",.22).toString());var c,e,f={style:a.css("font-style"),size:Math.round(.8*(+a.css("font-size").replace("px","")||13)),variant:a.css("font-variant"),
weight:a.css("font-weight"),family:a.css("font-family")};f.lineHeight=1.15*f.size;e=n.xaxes.length||1;for(b=0;b<e;++b)(c=n.xaxes[b])&&!c.tickColor&&(c.tickColor=c.color),c=d.extend(!0,{},n.xaxis,c),n.xaxes[b]=c,c.font&&(c.font=d.extend({},f,c.font),c.font.color||(c.font.color=c.color));e=n.yaxes.length||1;for(b=0;b<e;++b)(c=n.yaxes[b])&&!c.tickColor&&(c.tickColor=c.color),c=d.extend(!0,{},n.yaxis,c),n.yaxes[b]=c,c.font&&(c.font=d.extend({},f,c.font),c.font.color||(c.font.color=c.color));n.xaxis.noTicks&&
null==n.xaxis.ticks&&(n.xaxis.ticks=n.xaxis.noTicks);n.yaxis.noTicks&&null==n.yaxis.ticks&&(n.yaxis.ticks=n.yaxis.noTicks);n.x2axis&&(n.xaxes[1]=d.extend(!0,{},n.xaxis,n.x2axis),n.xaxes[1].position="top");n.y2axis&&(n.yaxes[1]=d.extend(!0,{},n.yaxis,n.y2axis),n.yaxes[1].position="right");n.grid.coloredAreas&&(n.grid.markings=n.grid.coloredAreas);n.grid.coloredAreasColor&&(n.grid.markingsColor=n.grid.coloredAreasColor);n.lines&&d.extend(!0,n.series.lines,n.lines);n.points&&d.extend(!0,n.series.points,
n.points);n.bars&&d.extend(!0,n.series.bars,n.bars);null!=n.shadowSize&&(n.series.shadowSize=n.shadowSize);null!=n.highlightColor&&(n.series.highlightColor=n.highlightColor);for(b=0;b<n.xaxes.length;++b)v(N,b+1).options=n.xaxes[b];for(b=0;b<n.yaxes.length;++b)v(T,b+1).options=n.yaxes[b];for(var g in R)n.hooks[g]&&n.hooks[g].length&&(R[g]=R[g].concat(n.hooks[g]));m(R.processOptions,[n])})(b);(function(){a.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove();"static"==a.css("position")&&
a.css("position","relative");K=new r("flot-base",a);ea=new r("flot-overlay",a);q=K.context;P=ea.context;X=d(ea.element).unbind();var b=a.data("plot");b&&(b.shutdown(),ea.clear());a.data("plot",G)})();k(c);z();J();n.grid.hoverable&&(X.mousemove(da),X.bind("mouseleave",Y));n.grid.clickable&&X.click(ia);m(R.bindEvents,[X]);var Z=[],ha=null}var c=Object.prototype.hasOwnProperty;r.prototype.resize=function(a,c){if(0>=a||0>=c)throw Error("Invalid dimensions for plot, width = "+a+", height = "+c);var b=
this.element,d=this.context,m=this.pixelRatio;this.width!=a&&(b.width=a*m,b.style.width=a+"px",this.width=a);this.height!=c&&(b.height=c*m,b.style.height=c+"px",this.height=c);d.restore();d.save();d.scale(m,m)};r.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};r.prototype.render=function(){var a=this._textCache,e;for(e in a)if(c.call(a,e)){var b=this.getTextLayer(e),d=a[e];b.hide();for(var m in d)if(c.call(d,m)){var k=d[m],g;for(g in k)if(c.call(k,g)){for(var p=k[g].positions,
r=0,v;v=p[r];r++)v.active?v.rendered||(b.append(v.element),v.rendered=!0):(p.splice(r--,1),v.rendered&&v.element.detach());0==p.length&&delete k[g]}}b.show()}};r.prototype.getTextLayer=function(a){var c=this.text[a];null==c&&(null==this.textContainer&&(this.textContainer=d("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),c=this.text[a]=d("<div></div>").addClass(a).css({position:"absolute",top:0,
left:0,bottom:0,right:0}).appendTo(this.textContainer));return c};r.prototype.getTextInfo=function(a,c,b,f,m){var k,g;c=""+c;f="object"===typeof b?b.style+" "+b.variant+" "+b.weight+" "+b.size+"px/"+b.lineHeight+"px "+b.family:b;k=this._textCache[a];null==k&&(k=this._textCache[a]={});g=k[f];null==g&&(g=k[f]={});k=g[c];null==k&&(a=d("<div></div>").html(c).css({position:"absolute","max-width":m,top:-9999}).appendTo(this.getTextLayer(a)),"object"===typeof b?a.css({font:f,color:b.color}):"string"===typeof b&&
a.addClass(b),k=g[c]={width:a.outerWidth(!0),height:a.outerHeight(!0),element:a,positions:[]},a.detach());return k};r.prototype.addText=function(a,c,b,d,m,k,g,p,r){a=this.getTextInfo(a,d,m,k,g);d=a.positions;"center"==p?c-=a.width/2:"right"==p&&(c-=a.width);"middle"==r?b-=a.height/2:"bottom"==r&&(b-=a.height);for(r=0;m=d[r];r++)if(m.x==c&&m.y==b){m.active=!0;return}m={active:!0,rendered:!1,element:d.length?a.element.clone():a.element,x:c,y:b};d.push(m);m.element.css({top:Math.round(b),left:Math.round(c),
"text-align":p})};r.prototype.removeText=function(a,d,b,f,m,k){if(null==f){if(d=this._textCache[a],null!=d)for(var g in d)if(c.call(d,g)){b=d[g];for(var p in b)if(c.call(b,p))for(a=b[p].positions,f=0;m=a[f];f++)m.active=!1}}else for(a=this.getTextInfo(a,f,m,k).positions,f=0;m=a[f];f++)m.x==d&&m.y==b&&(m.active=!1)};d.plot=function(a,c,b){return new s(d(a),c,b,d.plot.plugins)};d.plot.version="0.8.1";d.plot.plugins=[];d.fn.plot=function(a,c){return this.each(function(){d.plot(this,a,c)})}})(jQuery);
(function(d){var r={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(d,c){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+c.color+";'>"+d+"<br/>"+Math.round(c.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};d.plot.plugins.push({init:function(s){function c(a){for(var b=
0,c=0,e=0,g=r.series.pie.combine.color,f=[],k=0;k<a.length;++k){var m=a[k].data;d.isArray(m)&&1==m.length&&(m=m[0]);d.isArray(m)?!isNaN(parseFloat(m[1]))&&isFinite(m[1])?m[1]=+m[1]:m[1]=0:m=!isNaN(parseFloat(m))&&isFinite(m)?[1,+m]:[1,0];a[k].data=[m]}for(k=0;k<a.length;++k)b+=a[k].data[0][1];for(k=0;k<a.length;++k)m=a[k].data[0][1],m/b<=r.series.pie.combine.threshold&&(c+=m,e++,g||(g=a[k].color));for(k=0;k<a.length;++k)m=a[k].data[0][1],(2>e||m/b>r.series.pie.combine.threshold)&&f.push({data:[[1,
m]],color:a[k].color,label:a[k].label,angle:m*Math.PI*2/b,percent:m/(b/100)});1<e&&f.push({data:[[1,c]],color:g,label:r.series.pie.combine.label,angle:c*Math.PI*2/b,percent:c/(b/100)});return f}function a(a,b){function c(){t.clearRect(0,0,f,m);p.children().filter(".pieLabel, .pieLabelBackground").remove()}function g(){var a=r.series.pie.shadow.left,b=r.series.pie.shadow.top,c=r.series.pie.shadow.alpha,d=1<r.series.pie.radius?r.series.pie.radius:E*r.series.pie.radius;if(!(d>=f/2-a||d*r.series.pie.tilt>=
m/2-b||10>=d)){t.save();t.translate(a,b);t.globalAlpha=c;t.fillStyle="#000";t.translate(v,F);t.scale(1,r.series.pie.tilt);for(a=1;10>=a;a++)t.beginPath(),t.arc(0,0,d,0,2*Math.PI,!1),t.fill(),d-=a;t.restore()}}function k(){function a(b,c,d){0>=b||isNaN(b)||(d?t.fillStyle=c:(t.strokeStyle=c,t.lineJoin="round"),t.beginPath(),1E-9<Math.abs(b-2*Math.PI)&&t.moveTo(0,0),t.arc(0,0,g,z,z+b/2,!1),t.arc(0,0,g,z+b/2,z+b,!1),t.closePath(),z+=b,d?t.fill():t.stroke())}function b(){for(var a=c,e=1<r.series.pie.label.radius?
r.series.pie.label.radius:E*r.series.pie.label.radius,g=0;g<s.length;++g){if(s[g].percent>=100*r.series.pie.label.threshold){var k;k=s[g];var t=a,z=g;if(0==k.data[0][1])k=!0;else{var A=r.legend.labelFormatter,y=void 0,J=r.series.pie.label.formatter,y=A?A(k.label,k):k.label;J&&(y=J(y,k));A=(t+k.angle+t)/2;t=v+Math.round(Math.cos(A)*e);A=F+Math.round(Math.sin(A)*e)*r.series.pie.tilt;p.append("<span class='pieLabel' id='pieLabel"+z+"' style='position:absolute;top:"+A+"px;left:"+t+"px;'>"+y+"</span>");
z=p.children("#pieLabel"+z);y=A-z.height()/2;A=t-z.width()/2;z.css("top",y);z.css("left",A);0<0-y||0<0-A||0>m-(y+z.height())||0>f-(A+z.width())?k=!1:(0!=r.series.pie.label.background.opacity&&(t=r.series.pie.label.background.color,null==t&&(t=k.color),k="top:"+y+"px;left:"+A+"px;",d("<div class='pieLabelBackground' style='position:absolute;width:"+z.width()+"px;height:"+z.height()+"px;"+k+"background-color:"+t+";'></div>").css("opacity",r.series.pie.label.background.opacity).insertBefore(z)),k=!0)}if(!k)return!1}a+=
s[g].angle}return!0}var c=Math.PI*r.series.pie.startAngle,g=1<r.series.pie.radius?r.series.pie.radius:E*r.series.pie.radius;t.save();t.translate(v,F);t.scale(1,r.series.pie.tilt);t.save();for(var z=c,A=0;A<s.length;++A)s[A].startAngle=z,a(s[A].angle,s[A].color,!0);t.restore();if(0<r.series.pie.stroke.width){t.save();t.lineWidth=r.series.pie.stroke.width;z=c;for(A=0;A<s.length;++A)a(s[A].angle,r.series.pie.stroke.color,!1);t.restore()}e(t);t.restore();return r.series.pie.label.show?b():!0}if(p){var f=
a.getPlaceholder().width(),m=a.getPlaceholder().height(),H=p.children().filter(".legend").children().width()||0;t=b;$=!1;E=Math.min(f,m/r.series.pie.tilt)/2;F=m/2+r.series.pie.offset.top;v=f/2;v="auto"==r.series.pie.offset.left?r.legend.position.match("w")?v+H/2:v-H/2:v+r.series.pie.offset.left;v<E?v=E:v>f-E&&(v=f-E);var s=a.getData(),H=0;do 0<H&&(E*=.95),H+=1,c(),.8>=r.series.pie.tilt&&g();while(!k()&&10>H);10<=H&&(c(),p.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>"));
a.setSeries&&a.insertLegend&&(a.setSeries(s),a.insertLegend())}}function e(a){if(0<r.series.pie.innerRadius){a.save();var b=1<r.series.pie.innerRadius?r.series.pie.innerRadius:E*r.series.pie.innerRadius;a.globalCompositeOperation="destination-out";a.beginPath();a.fillStyle=r.series.pie.stroke.color;a.arc(0,0,b,0,2*Math.PI,!1);a.fill();a.closePath();a.restore();a.save();a.beginPath();a.strokeStyle=r.series.pie.stroke.color;a.arc(0,0,b,0,2*Math.PI,!1);a.stroke();a.closePath();a.restore()}}function b(a){m("plothover",
a)}function f(a){m("plotclick",a)}function m(a,b){var c=s.offset(),d=parseInt(b.pageX-c.left);a:{for(var c=parseInt(b.pageY-c.top),e=s.getData(),g=s.getOptions(),g=1<g.series.pie.radius?g.series.pie.radius:E*g.series.pie.radius,f,m,$=0;$<e.length;++$){var y=e[$];if(y.pie.show){t.save();t.beginPath();t.moveTo(0,0);t.arc(0,0,g,y.startAngle,y.startAngle+y.angle/2,!1);t.arc(0,0,g,y.startAngle+y.angle/2,y.startAngle+y.angle,!1);t.closePath();f=d-v;m=c-F;if(t.isPointInPath){if(t.isPointInPath(d-v,c-F)){t.restore();
d={datapoint:[y.percent,y.data],dataIndex:0,series:y,seriesIndex:$};break a}}else{var M=g*Math.cos(y.startAngle),V=g*Math.sin(y.startAngle),da=g*Math.cos(y.startAngle+y.angle/4),Y=g*Math.sin(y.startAngle+y.angle/4),ia=g*Math.cos(y.startAngle+y.angle/2),ga=g*Math.sin(y.startAngle+y.angle/2),ca=g*Math.cos(y.startAngle+y.angle/1.5),la=g*Math.sin(y.startAngle+y.angle/1.5),ka=g*Math.cos(y.startAngle+y.angle),ja=g*Math.sin(y.startAngle+y.angle),M=[[0,0],[M,V],[da,Y],[ia,ga],[ca,la],[ka,ja]];f=[f,m];m=!1;
V=-1;da=M.length;for(Y=da-1;++V<da;Y=V)(M[V][1]<=f[1]&&f[1]<M[Y][1]||M[Y][1]<=f[1]&&f[1]<M[V][1])&&f[0]<(M[Y][0]-M[V][0])*(f[1]-M[V][1])/(M[Y][1]-M[V][1])+M[V][0]&&(m=!m);if(m){t.restore();d={datapoint:[y.percent,y.data],dataIndex:0,series:y,seriesIndex:$};break a}}t.restore()}}d=null}if(r.grid.autoHighlight)for(c=0;c<O.length;++c)e=O[c],e.auto!=a||d&&e.series==d.series||(e=e.series,null==e&&(O=[],s.triggerRedrawOverlay()),e=k(e),-1!=e&&(O.splice(e,1),s.triggerRedrawOverlay()));d&&(c=d.series,e=k(c),
-1==e?(O.push({series:c,auto:a}),s.triggerRedrawOverlay()):a||(O[e].auto=!1));p.trigger(a,[{pageX:b.pageX,pageY:b.pageY},d])}function k(a){for(var b=0;b<O.length;++b)if(O[b].series==a)return b;return-1}var g=null,p=null,E=null,v=null,F=null,$=!1,t=null,O=[];s.hooks.processOptions.push(function(a,b){b.series.pie.show&&(b.grid.show=!1,"auto"==b.series.pie.label.show&&(b.series.pie.label.show=b.legend.show?!1:!0),"auto"==b.series.pie.radius&&(b.series.pie.radius=b.series.pie.label.show?.75:1),1<b.series.pie.tilt?
b.series.pie.tilt=1:0>b.series.pie.tilt&&(b.series.pie.tilt=0))});s.hooks.bindEvents.push(function(a,c){var d=a.getOptions();d.series.pie.show&&(d.grid.hoverable&&c.unbind("mousemove").mousemove(b),d.grid.clickable&&c.unbind("click").click(f))});s.hooks.processDatapoints.push(function(a,b,e,f){a.getOptions().series.pie.show&&!$&&($=!0,g=a.getCanvas(),p=d(g).parent(),r=a.getOptions(),a.setData(c(a.getData())))});s.hooks.drawOverlay.push(function(a,b){if(a.getOptions().series.pie.show){var c=a.getOptions(),
d=1<c.series.pie.radius?c.series.pie.radius:E*c.series.pie.radius;b.save();b.translate(v,F);b.scale(1,c.series.pie.tilt);for(var g=0;g<O.length;++g){var f=O[g].series;0>=f.angle||isNaN(f.angle)||(b.fillStyle="rgba(255, 255, 255, "+c.series.pie.highlight.opacity+")",b.beginPath(),1E-9<Math.abs(f.angle-2*Math.PI)&&b.moveTo(0,0),b.arc(0,0,d,f.startAngle,f.startAngle+f.angle/2,!1),b.arc(0,0,d,f.startAngle+f.angle/2,f.startAngle+f.angle,!1),b.closePath(),b.fill())}e(b);b.restore()}});s.hooks.draw.push(function(b,
c){b.getOptions().series.pie.show&&a(b,c)})},options:r,name:"pie",version:"1.1"})})(jQuery);
(function(d,r){var s=0;d.widget("s3.pivottable",{options:{showTotals:!0,ajaxURL:null,defaultChart:{type:"breakdown",axis:"rows"},renderFilter:!0,renderOptions:!0,renderChart:!0,renderTable:!0,collapseFilter:!1,collapseOptions:!0,collapseChart:!0,collapseTable:!1,exploreChart:!1,filterURL:null,filterForm:null,filterTab:null,autoSubmit:1E3,thousandSeparator:" ",thousandGrouping:"3"},_create:function(){this.id=s;s+=1;this.chart=this.table=null},_init:function(){var c=d(this.element);this.table=this.data=
null;this.chart_options={currentChart:null,currentDataIndex:null,currentSeriesIndex:null};this.table_options={hidden:!1};var a=c.find(".pt-chart");this.chart=a.length?a.first():null;this.options.renderFilter||this.options.renderOptions?(a=c.attr("id"),this.options.renderOptions?(d("#"+a+"-options").show(),this.options.collapseOptions&&(d("#"+a+"-options legend").siblings().toggle(),d("#"+a+"-options legend").children().toggle())):d("#"+a+"-options").hide(),this.options.renderFilter?(d("#"+a+"-filters").show(),
this.options.collapseFilter&&(d("#"+a+"-filters legend").siblings().toggle(),d("#"+a+"-filters legend").children().toggle())):d("#"+a+"-options").hide()):c.find(".pt-form-container").hide();this.options.collapseTable&&(this.table_options.hidden=!0,c.find(".pt-table").hide(),c.find(".pt-show-table").show(),c.find(".pt-hide-table").hide());var e=new RegExp("\\B(?=(\\d{"+this.options.thousandGrouping+"})+(?!\\d))","g"),b=this.options.thousandSeparator;this.options.thousandFormatter=function(a){return a.toString().replace(e,
b)};this.refresh()},_destroy:function(){this.table&&this.table.remove();this.chart&&this.chart.empty()},refresh:function(){var c=d(this.element),a=null;this._unbindEvents();var e=c.find('input[type="hidden"][name="pivotdata"]');e.length&&(a=JSON.parse(d(e).first().val()));a||(a={empty:!0},c.find(".pt-hide-table").hide(),c.find(".pt-show-table").hide());this.data=a;a.nodata?(c.find(".pt-table").first().empty().append(d('<div class="pt-no-data">'+a.nodata+"</div>")),c.find(".pt-hide-table").hide(),
c.find(".pt-show-table").hide()):(this._renderTable(),this._renderChartOptions());this._renderChart();a.empty?c.find(".pt-empty").show():c.find(".pt-empty").hide();this.options.autoSubmit?c.find(".pt-submit").hide():c.find(".pt-submit").show();this._bindEvents();c.find(".pt-throbber").hide()},_renderTable:function(){var c=d(this.element),a=c.find(".pt-table").first().empty();this.table=null;var e=this.data;if(!e.empty)if(this.options.renderTable){var b=e.cells,f=e.cols,m=e.rows,k=e.total,g=e.labels,
e=this._renderHeader(f,g);e.append(this._renderColumns(f,g));b=this._renderRows(m,f,g,b);f=this._renderFooter(m,f,g,k);m=d('<table class="dataTable display report"/>').append(e).append(b);null!==f&&m.append(f);this.table=d(m);d(a).append(this.table);this.table_options.hidden?(c.find(".pt-show-table").show(),c.find(".pt-hide-table").hide()):(c.find(".pt-show-table").hide(),c.find(".pt-hide-table").show())}else c.find(".pt-show-table").hide(),c.find(".pt-hide-table").hide()},_renderHeader:function(c,
a){var e=d("<tr>");colspan="__other__"==c[c.length-1][0]?c.length-1:c.length;e.append(d('<th scope="col">'+a.layer+"</th>"));(1<c.length||c[0][4])&&e.append(d('<th scope="col" colspan="'+colspan+'">'+a.cols+"</th>"));this.options.showTotals&&e.append(d('<th class="totals_header row_totals" scope="col" rowspan="2">'+a.total+"</th>"));return d("<thead>").append(e)},_renderColumns:function(c,a){var e=d("<tr>"),b;e.append(d('<th scope="col">'+a.rows+"</th>"));for(var f=1==c.length&&null===c[0][4]?!0:
!1,m=0;m<c.length;m++)"__other__"==c[m][0]||f&&this.options.showTotals||(b=f?"":c[m][4],e.append(d('<th scope="col">'+b+"</th>")));return e},_renderRows:function(c,a,e,b){for(var f=d("<tbody>"),m=this.options.showTotals,k=1==c.length&&null===c[0][4]?!0:!1,g,p,r=0;r<b.length;r++)g=c[r],"__other__"==g[0]||k&&this.options.showTotals||(p=k?"":c[r][4],p=d('<tr class="'+(r%2?"odd":"even")+'"><td>'+p+"</td></tr>").append(this._renderCells(b[r],a,e)),m&&p.append(d("<td>"+g[2]+"</td>")),f.append(p));return f},
_renderCells:function(c,a,e){for(var b,f=e.none,m=1==a.length&&null===a[0][4]?!0:!1,k=[],g,p,r=0;r<c.length;r++)if(!("__other__"==a[r][0]||m&&this.options.showTotals)){b=c[r];e=b.items;g=d("<td>");if(null===e)p=d('<div class="pt-cell-value">'+f+"</div>");else if(d.isArray(e)){p=d('<div class="pt-cell-value">');list=d("<ul>");for(var v=0;v<e.length;v++)list.append(d("<li>"+e[v]+"</li>"));p.append(list)}else p=d('<div class="pt-cell-value">'+e+"</div>");g.append(p);b=b.keys;e&&b&&b.length&&g.data("records",
b).append(d('<div class="pt-cell-zoom"></div>'));k.push(g)}return k},_renderFooter:function(c,a,e,b){var f=1==a.length&&null===a[0][4]?!0:!1;if(this.options.showTotals){var m,k;k=m=0;for(len=c.length;m<len;m++)"__other__"!=c[m][0]&&k++;c=d('<tr class="'+(k%2?"odd":"even")+' totals_row"><th class="totals_header" scope="row">'+e.total+"</th></tr>");for(m=0;m<a.length;m++)"__other__"==a[m][0]||f||c.append(d("<td>"+a[m][2]+"</td>"));c.append(d("<td>"+b+"</td>"));return d("<tfoot>").append(c)}return null},
_renderChartOptions:function(){var c=d(this.element),a=c.find(".pt-chart-controls").first().empty(),e=this.data;if(!e.empty&&this.options.renderChart){var e=e.labels,b=c.attr("id"),c=e.layer,f=e.rows,m=e.cols,k=e.per,g=d('<div class="pt-chart-opts">'),p=b+"-pchart-rows",r=b+"-vchart-rows",v=b+"-hchart-rows",F=b+"-pchart-cols",s=b+"-vchart-cols",b=b+"-hchart-cols";c&&d(g).append(d('<span class="pt-chart-label">'+c+": </span>"));f&&d(g).append(d('<div id="'+p+'" class="pt-chart-icon pt-pchart"/><div id="'+
r+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+k+" "+f+"</span>"));m&&d(g).append(d('<div id="'+F+'" class="pt-chart-icon pt-pchart"/><div id="'+s+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+k+" "+m+"</span>"));f&&m&&d(g).append(d('<span class="pt-chart-label">| '+e.breakdown+': </span><div id="'+v+'" class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+[k,f,"&amp;",m].join(" ")+'</span><div id="'+b+'"  class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+
[k,m,"&amp;",f].join(" ")+"</span>"));d(a).append(g)}},_truncateLabel:function(c,a){return c.length>a?c.substring(0,a-3).replace(/\s+$/g,"")+"...":c},_renderChart:function(c){var a=d(this.element),e=this.data;a.find(".pt-chart-contents").hide();if(a=this.chart)if(d(a).unbind("plothover").unbind("plotclick").empty(),!e.empty&&this.options.renderChart)if(!1===c)this.options.collapseChart=!0;else{a=this.options.collapseChart;if("undefined"==typeof c||!c){if(a)return;c=this.chart_options.currentChart}if("undefined"==
typeof c||!c){if(a)return;c=this.options.defaultChart}if("undefined"!=typeof c&&c){this.options.collapseChart=!1;this.chart_options.currentChart=c;a=c.type;c=c.axis;var b=e.labels,f=b.per,m=b.layer+" "+f+" "+b.rows,b=b.layer+" "+f+" "+b.cols,f=e.filter,k=f[0],g=f[1];"piechart"==a?"rows"==c?this._renderPieChart(e.rows,m,k):this._renderPieChart(e.cols,b,g):"barchart"==a?"rows"==c?this._renderBarChart(e.rows,m,k):this._renderBarChart(e.cols,b,g):"breakdown"==a&&("rows"==c?this._renderBreakDown(e,0,m,
f):this._renderBreakDown(e,1,b,f))}}},_renderPieChart:function(c,a,e){var b=this.chart;if(b){d(b).closest(".pt-chart-contents").show().css({width:"800px"});d(b).css({height:"360px"});for(var f=[],m=0;m<c.length;m++){var k=c[m];k[1]||f.push({label:k[4],data:k[2],key:k[3]})}a?d(b).siblings(".pt-chart-title").html("<h4>"+a+"</h4>"):d(b).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(b),f,{series:{pie:{show:!0,radius:125}},legend:{show:!0,position:"ne"},grid:{hoverable:!0,clickable:!0}});
var g=this;this.chart_options.currentDataIndex=null;d(b).bind("plothover",function(a,b,c){if(c){if(g.chart_options.currentDataIndex!=c.seriesIndex){g._removeChartTooltip();g.chart_options.currentDataIndex=c.seriesIndex;a=c.series.data[0][1];var e=c.series.percent.toFixed(1),f='<div class="pt-tooltip-label">'+c.series.label+"</div>";g._renderChartTooltip(b.pageX,b.pageY,f+('<div class="pt-tooltip-text">'+a+" ("+e+"%)</div>"));d(".pt-tooltip-label").css({color:c.series.color})}}else g._removeChartTooltip()});
this.options.exploreChart&&e&&d(b).bind("plotclick",function(a,b,c){if(c){try{var d=[[e,f[c.seriesIndex].key]]}catch(k){return}g._chartExplore(d)}})}},_renderBarChart:function(c,a,e){var b=this.chart,f=this._truncateLabel;if(b){d(b).closest(".pt-chart-contents").show().css({width:"96%"});d(b).css({height:"360px"});for(var m=[],k=[],g=0,p=0;p<c.length;p++){var r=c[p];r[1]||(m.push({label:r[4],data:[[g+1,r[2]]],key:r[3]}),k.push([g+1,f(r[4],16)]),g++)}a?d(b).siblings(".pt-chart-title").html("<h4>"+
a+"</h4>"):d(b).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(b),m,{series:{bars:{show:!0,barWidth:.6,align:"center"}},legend:{show:!1,position:"ne"},grid:{hoverable:!0,clickable:!0},xaxis:{ticks:k,min:0,max:m.length+1,tickLength:0},yaxis:{tickFormatter:this.options.thousandFormatter}});var v=this;this.chart_options.currentDataIndex=null;d(b).bind("plothover",function(a,b,c){c?v.chart_options.currentDataIndex!=c.seriesIndex&&(v._removeChartTooltip(),v.chart_options.currentDataIndex=
c.seriesIndex,a='<div class="pt-tooltip-label">'+c.series.label+"</div>",a+='<div class="pt-tooltip-text">'+c.series.data[0][1]+"</div>",v._renderChartTooltip(b.pageX,b.pageY,a),d(".pt-tooltip-label").css({color:c.series.color})):v._removeChartTooltip()});this.options.exploreChart&&e&&d(b).bind("plotclick",function(a,b,c){if(c){try{var d=[[e,m[c.seriesIndex].key]]}catch(g){return}v._chartExplore(d)}})}},_renderBreakDown:function(c,a,e,b){var f=this.chart;if(f){d(f).closest(".pt-chart-contents").show().css({width:"96%"});
var m,k,g=c.cells,p,r=[],v=[];0===a?(a=c.rows,p=c.cols,c=function(a,b){return g[r[a]][v[b]].value},m=b[0],k=b[1]):(a=c.cols,p=c.rows,c=function(a,b){return g[v[b]][r[a]].value},m=b[1],k=b[0]);var F=[],s=[];b=0;for(len=a.length;b<len;b++)a[b][1]||(F.push(a[b]),r.push(b));b=0;for(len=p.length;b<len;b++)p[b][1]||(s.push(p[b]),v.push(b));b=Math.max(F.length*Math.max(16*(s.length+1),50)+70,360);d(f).css({height:b+"px"});b=[];for(var t=a=0;t<s.length;t++){for(var O={label:s[t][4]},z=[],A,J=0;J<F.length;J++)p=
(F.length-J)*(s.length+1)-t,A=c(J,t),A>a&&(a=A),z.push([A,p]);O.data=z;b.push(O)}c=[];for(J=0;J<F.length;J++)t=F[J][4],p=(F.length-J)*(s.length+1)+1,c.push([p,t]);e?d(f).siblings(".pt-chart-title").html("<h4>"+e+"</h4>"):d(f).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(f),b,{series:{bars:{show:!0,barWidth:.8,align:"center",horizontal:!0}},legend:{show:!0,position:"ne"},yaxis:{ticks:c,labelWidth:120,max:F.length*(s.length+1)+1},xaxis:{max:1.1*a,tickFormatter:this.options.thousandFormatter},
grid:{hoverable:!0,clickable:!0}});d(".flot-y-axis .tickLabel").css({"padding-top":"25px",left:"0px",width:"120px"});var W=this;this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null;d(f).bind("plothover",function(a,b,c){if(c){if(W.chart_options.currentDataIndex!=c.dataIndex||W.chart_options.currentSeriesIndex!=c.seriesIndex)W._removeChartTooltip(),W.chart_options.currentDataIndex=c.dataIndex,W.chart_options.currentSeriesIndex=c.seriesIndex,a='<div class="pt-tooltip-label">'+
F[c.dataIndex][4]+"</div>",a+='<div class="pt-tooltip-text">'+c.series.label+' : <span class="pt-tooltip-value">'+c.datapoint[0]+"</span></div>",W._renderChartTooltip(b.pageX,b.pageY,a),d(".pt-tooltip-label").css({"padding-bottom":"8px"}),d(".pt-tooltip-text").css({color:c.series.color}),d(".pt-tooltip-value").css({"font-weight":"bold"})}else W._removeChartTooltip()});this.options.exploreChart&&m&&k&&d(f).bind("plotclick",function(a,b,c){if(c){try{var d=[[m,F[c.dataIndex][3]],[k,s[c.seriesIndex][3]]]}catch(e){return}W._chartExplore(d)}})}},
_chartExplore:function(c){var a=this.options,e=d(this.element).closest(".ui-tabs"),b=a.filterTab;if(e.length&&!1!==b)a=(a=a.filterForm)?d("#"+a):r,S3.search.setCurrentFilters(a,c),c=b?d("#"+b).index():0,e.tabs("option","active",c);else if(filterURL=a.filterURL)e=this._updateURL(filterURL,c),window.open(e,"_blank")},_renderChartTooltip:function(c,a,e){d('<div class="pt-chart-tooltip">'+e+"</div>").css({position:"absolute",display:"none",top:a-50,left:c+10,border:"1px solid #999",padding:"10px","min-height":"50px",
"max-width":"240px","z-index":"501","background-color":"white",color:"#000",opacity:.95}).appendTo("body").fadeIn(200)},_removeChartTooltip:function(){d(".pt-chart-tooltip").remove();this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null},_getOptions:function(){var c="#"+d(this.element).attr("id");return{rows:d(c+"-rows").val(),cols:d(c+"-cols").val(),fact:d(c+"-fact").val(),totals:d(c+"-totals").is(":checked")?1:0}},_getFilters:function(){var c="#"+d(this.element).attr("id"),
c=d(c+"-filters");try{return c.length?S3.search.getCurrentFilters(c.first()):null}catch(a){}},_updateURL:function(c,a){var d,b,f=[],m={};d={};var k,g,p;if(a)for(k=0,len=a.length;k<len;k++)d=a[k],p=d[0],m[p]=!0,f.push(p+"="+d[1]);d=this.options.ajaxURL.split("?");if(1<d.length){b=d[1].split("&");d={};k=0;for(len=b.length;k<len;k++)g=b[k].split("="),1<g.length&&(p=decodeURIComponent(g[0]),m[p]||(f.push(p+"="+decodeURIComponent(g[1])),d[p]=!0));for(p in d)m[p]=!0}d=c.split("?");if(1<d.length)for(b=d[1].split("&"),
k=0,len=b.length;k<len;k++)g=b[k].split("="),1<g.length&&(p=decodeURIComponent(g[0]),m[p]||f.push(p+"="+decodeURIComponent(g[1])));f=f.join("&");m=d[0];f&&(m=m+"?"+f);return m},_updateAjaxURL:function(c,a){var e=this.options.ajaxURL.split("?"),b=null,b=[],f=!1,m;1<e.length?(m=e[1],m=m.split("&")):m=[];var k,g;if(c)for(k in c)newopt=c[k],g=k+"="+newopt,"totals"==k?this.options.showTotals=newopt?!0:!1:f||-1!=d.inArray(g,m)||(f=!0),b.push(g);k={};var p={},r,v,s;if(a)for(r=0,v=a.length;r<v;r++)g=a[r],
s=g[0],g=g[1],null===g?k[s]||(p[s]=!0):(p[s]&&(p[s]=!1),k[s]?k[s].push(s+"="+g):k[s]=[s+"="+g]);r=0;for(v=m.length;r<v;r++)g=m[r].split("="),1<g.length&&(s=decodeURIComponent(g[0]),g=decodeURIComponent(g[1]),p[s]?f=!0:k[s]?f||-1!=d.inArray(s+"="+g,k[s])||(f=!0):"aggregate"!=s&&(c&&c.hasOwnProperty(s)||b.push(m[r])));for(s in k)for(r=0,v=k[s].length;r<v;r++)f||-1!=d.inArray(k[s][r],m)||(f=!0),b.push(k[s][r]);b=b.join("&");e=e[0];b&&(e=e+"?"+b);this.options.ajaxURL=e;return f},reload:function(c,a,e){e=
"undefined"!=typeof e?e:!0;"undefined"==typeof a&&(a=this._getFilters());var b=this,f=this.element,m,k=f.find('input[type="hidden"][name="pivotdata"]');if(k.length){f.find(".pt-throbber").show();if(c||a)m=this._updateAjaxURL(c,a);m||e?(c=this.options.ajaxURL,f.find(".pt-empty").hide(),d.ajax({url:c,dataType:"json"}).done(function(a){k.first().val(JSON.stringify(a));b.refresh()}).fail(function(a,b,c){msg="UNAUTHORIZED"==c?i18n.gis_requires_login:a.responseText;console.log(msg)})):b.refresh()}},_bindEvents:function(c){var a=
this,e=d(this.element);c=this.data;var b=e.attr("id");d("#"+b+"-options legend").click(function(){d(this).siblings().toggle();d(this).children().toggle()});d("#"+b+"-filters legend").click(function(){d(this).siblings().toggle();d(this).children().toggle()});e.find(".pt-hide-table").click(function(){a.table_options.hidden=!0;e.find(".pt-table").hide();d(this).siblings(".pt-show-table").show();d(this).hide()});e.find(".pt-show-table").click(function(){a.table_options.hidden=!1;e.find(".pt-table").show();
d(this).siblings(".pt-hide-table").show();d(this).hide()});d("#"+b+"-totals").click(function(){var b=d(this).is(":checked");a.options.showTotals!=b&&a.reload({totals:b},null,!1)});d("#"+b+"-rows, #"+b+"-cols, #"+b+"-fact").on("change.autosubmit",function(){d("#"+b+"-pt-form").trigger("optionChanged")});if(this.options.autoSubmit){var f=this.options.autoSubmit;d("#"+b+"-pt-form").on("optionChanged",function(){var b=d(this);if(!b.data("noAutoSubmit")){var c=b.data("autoSubmitTimeout");c&&clearTimeout(c);
c=setTimeout(function(){var b=a._getOptions(),c=a._getFilters();a.reload(b,c,!1)},f);b.data("autoSubmitTimeout",c)}})}else d("#"+b+"-pt-form input.pt-submit").click(function(){var b=a._getOptions(),c=a._getFilters();a.reload(b,c,!1)});d("#"+b+" div.pt-table div.pt-cell-zoom").click(function(a){a=d(a.currentTarget);var b=a.closest("td"),e=b.find(".pt-cell-records");if(0<e.length)e.remove(),a.removeClass("opened");else{for(var f=b.data("records"),e=d("<div/>").addClass("pt-cell-records"),r=d("<ul/>"),
s=0;s<f.length;s++)r.append("<li>"+c.lookup[f[s]]+"</li>");e.append(r);b.append(e);a.addClass("opened")}});d("#"+b+"-pchart-rows").click(function(){a._renderChart({type:"piechart",axis:"rows"})});d("#"+b+"-vchart-rows").click(function(){a._renderChart({type:"barchart",axis:"rows"})});d("#"+b+"-pchart-cols").click(function(){a._renderChart({type:"piechart",axis:"cols"})});d("#"+b+"-vchart-cols").click(function(){a._renderChart({type:"barchart",axis:"cols"})});d("#"+b+"-hchart-rows").click(function(){a._renderChart({type:"breakdown",
axis:"rows"})});d("#"+b+"-hchart-cols").click(function(){a._renderChart({type:"breakdown",axis:"cols"})});e.find(".pt-hide-chart").click(function(){a._renderChart(!1)})},_unbindEvents:function(){var c=d(this.element),a=c.attr("id");d("#"+a+" div.pt-table div.pt-cell-zoom").unbind("click");d("#"+a+"-options legend").unbind("click");d("#"+a+"-filters legend").unbind("click");d(a+"-totals").unbind("click");d("#"+a+"-rows, #"+a+"-cols, #"+a+"-fact").unbind("change.autosubmit");d("#"+a+"-pt-form").unbind("optionChanged");
c.find("input.pt-submit").unbind("click");d("#"+a+"-pchart-rows").unbind("click");d("#"+a+"-vchart-rows").unbind("click");d("#"+a+"-pchart-cols").unbind("click");d("#"+a+"-vchart-cols").unbind("click");c.find(".pt-hide-table").unbind("click");c.find(".pt-show-table").unbind("click");c.find(".pt-hide-chart").unbind("click")}})})(jQuery);
