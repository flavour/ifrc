$("#contact-add").click(function(){$("#contact-add_throbber").removeClass("hide").show();var a=$(this);$("#popup").remove();var c=S3.Ap.concat("/pr/contact/create.iframe");$.get(c,function(b){a.hide();a.after("<div></div>");a.next().html(b);b=S3.Ap.concat("/pr/contact/create?person="+personId+"&controller="+controller);$("#popup").find("form").attr("action",b);$("#contact-add_throbber").hide()})});
$(".contact").each(function(){var a=$(this),c=a.attr("id").match(/\d+/);a.find("a.delete-btn-ajax").click(function(){confirm(i18n.delete_confirmation)&&($.post(S3.Ap.concat("/pr/contact/"+c[0]+"/delete")),a.addClass("hide"))});a.find("a.editBtn").click(function(){var b=a.find("span"),e=b.html(),g=$("<div>").addClass("form-container"),d=$("<form>");g.append(d);var f=$('<input id="pr_contact_value" size=62>');f.val(e);d.append(f);e=$('<input type="submit" class="fright">');e.val("Save");d.append(e);
b.replaceWith(g);a.addClass("edit");d.submit(function(b){b.preventDefault();$("#pr_contact_value_error").remove();a.removeClass("edit").addClass("saving");d.append($('<img class="pr_contact_throbber" src="'+S3.Ap.concat("/static/img/jquery-ui/ui-anim_basic_16x16.gif")+'">').addClass("fright"));d.find("input[type=submit]").addClass("hide");$.post(S3.Ap.concat("/pr/contact/"+c[0]+".s3json"),'{"$_pr_contact":'+JSON.stringify({value:f.val()})+"}",function(b){if("failed"==b.status){try{error_message=b.tree.$_pr_contact[0].value["@error"]}catch(c){error_message=
b.message}$("#pr_contact_value").after($('<div id="pr_contact_value_error" class="error">'+error_message+"</div>").css({display:"none"}).slideDown("slow").click(function(){$(this).fadeOut("slow");return!1}));a.removeClass("saving").addClass("edit");d.find("input[type=submit]").removeClass("hide");$(".pr_contact_throbber").remove()}else a.removeClass("saving"),b=f.val(),g.replaceWith($("<span>").html(b))},"json")})})});
$("#emergency-add").click(function(){$("#emergency-add_throbber").removeClass("hide").show();var a=$(this);$("#popup").remove();var c=S3.Ap.concat("/pr/contact_emergency/create.iframe");$.get(c,function(b){a.hide();a.after("<div></div>");a.next().html(b);b=S3.Ap.concat("/pr/contact_emergency/create?person="+personId+"&controller="+controller);$("#popup").find("form").attr("action",b);$("#emergency-add_throbber").hide()})});
$(".emergency").each(function(){var a=$(this),c=a.attr("id").match(/\d+/);a.find("a.delete-btn-ajax").click(function(){confirm(i18n.delete_confirmation)&&($.post(S3.Ap.concat("/pr/contact_emergency/"+c+"/delete")),a.addClass("hide"))});a.find("a.editBtn").click(function(){$("#emergency-add_throbber").removeClass("hide").show();var b=S3.Ap.concat("/pr/contact_emergency/"+c+".iframe/update");$.get(b,function(b){$("#popup").remove();a.hide();a.after("<div></div>");a.next().html(b);b=S3.Ap.concat("/pr/contact_emergency/"+
c+"/update?person="+personId+"&controller="+controller);$("#popup").find("form").attr("action",b);$("#emergency-add_throbber").hide()})})});
